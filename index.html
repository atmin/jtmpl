<!doctype html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="css/baseline.css">
        <link rel="stylesheet" type="text/css" href="css/highlight.css">
    	<style>
    		body {padding: 1% 7% 0 7%; color:#586e75}
    		h1 em {color:#DDD; font-style:normal}
            h2 {margin-top:64px}
            ul {margin-bottom:32px}
            footer {margin:40px 0 10px}
    	</style>
        <title>jtmpl</title>
    </head>
    <body>
    	<a href="https://github.com/atmin/jtmpl"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub"></a>
        <h1><em><code>{{</code></em> <code>jtmpl</code> <em><code>}}</code></em></h1>
<h4>Humanistic JavaScript MV framework</h4>
<p><br>
 <em>Kitchensink seems working. First release coming very soon</em></p>
<h2>What</h2>
<p><code>jtmpl</code> is a DOM-aware templating engine. It renders a <a href="http://mustache.github.io">Mustache</a> HTML template using a <code>model</code> object and infers bindings from template structure, so when <code>model</code> changes DOM is updated accordingly and vice versa. </p>
<p>There&#39;s never need to touch the DOM directly, <code>model</code> is the <a href="http://en.wikipedia.org/wiki/Single_Source_of_Truth">single source of truth</a></p>
<p>Other JavaScript MV* frameworks require you either:</p>
<ul>
<li><p>explicitly specify (via code or DOM element attributes) how to do the binding</p>
</li>
<li><p>build DOM via code :(</p>
</li>
</ul>
<p><code>jtmpl</code> provides you <em>live</em> templates that just work.</p>
<h2>Why</h2>
<ul>
<li><p>embrace <a href="http://en.wikipedia.org/wiki/Keep_it_simple">KISS</a> and <a href="http://en.wikipedia.org/wiki/Don&#39;t_repeat_yourself">DRY</a></p>
</li>
<li><p>write least amount of code possible</p>
</li>
<li><p>ideas by humans, automation by computers</p>
</li>
</ul>
<h2>How</h2>
<ol>
<li><p>Compile template using a <code>model</code> object into a valid HTML string (with added metadata)</p>
<p> <code>Stage1</code> can be processed server-side or browser-side</p>
</li>
<li><p>Using <code>Stage1</code> output generate DOM and bind elements properties to <code>model</code> properties </p>
</li>
</ol>
<h2>Hello, world</h2>
<ul>
<li><code>Stage1</code> is a template compiler</li>
</ul>
<pre><code>$ jtmpl(&#39;Hello, {{who}}&#39;, { who: &#39;server&#39; })

Hello, &lt;span data-jt=&quot;who&quot;&gt;server&lt;/span&gt;</code></pre>
<ul>
<li><code>Stage2</code> is a <a href="http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">MV(C)</a> framework for the browser</li>
</ul>
<!-- [Link to example](hello.html) -->


<pre><code>$ hello.html

&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;script src=&quot;js/jtmpl.min.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;!-- View --&gt;
    &lt;script id=&quot;view&quot; type=&quot;text/html&quot;&gt;
        Hello, {{who}}
        &lt;button onclick={{click}}&gt;{{buttonText}}&lt;/button&gt;
    &lt;/script&gt;

    &lt;!-- Model (View is controlled implicitly) --&gt;
    &lt;script&gt;
        model = {
            who: &#39;browser&#39;,
            buttonText: &#39;Shout&#39;,
            click: function() {
                with (this) {
                    if (who == &#39;browser&#39;) {
                        who = &#39;BROWSER&#39;; 
                        buttonText = &#39;Keep quiet&#39;;
                    }
                    else {
                        who = &#39;browser&#39;; 
                        buttonText = &#39;Shout again&#39;;
                    } 
                }
            }
        }

        jtmpl(&quot;#view&quot;, &quot;#view&quot;, model)
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<iframe src="hello.html"></iframe>





<h2>Specifications</h2>
<ul>
<li><p>based on <a href="http://updates.html5rocks.com/2012/11/Respond-to-change-with-Object-observe">Object.observe</a></p>
</li>
<li><p>no dependencies, <a href="https://github.com/jdarling/Object.observe">polyfill</a> built-in</p>
</li>
<li><p>less than 5KB minified and gzipped</p>
</li>
<li><p>Firefox, Chrome, Opera, IE 9 (IE8 requires Array.isArray, Array.map, Function.bind and String.trim <a href="http://stackoverflow.com/questions/2790001/fixing-javascript-array-functions-in-internet-explorer-indexof-foreach-etc">polyfills</a>)</p>
</li>
</ul>
<h2>Downloads</h2>
<ul>
<li><p>browse <a href="https://github.com/atmin/jtmpl/blob/dev/src/coffee/jtmpl.coffee">jtmpl.coffee</a></p>
</li>
<li><p><a href="js/jtmpl.js">jtmpl.js</a></p>
</li>
<li><p><a href="js/jtmpl.min.js">jtmpl.min.js</a></p>
</li>
</ul>
<h2>Details</h2>
<h3>API</h3>
<ul>
<li><p><code>jtmpl(&#39;template or &quot;#element-id&quot;&#39;, model)</code>&mdash;compiles template string (or #element-id innerHTML) using <code>model</code></p>
</li>
<li><p><code>jtmpl(&#39;#target-id&#39; or domElement, &#39;template contents or &quot;#template-id&quot;&#39;, model)</code>&mdash;compiles a template using <code>model</code>, injects it into target and binds it to <code>model</code>. </p>
<ul>
<li>template contents can be already prerendered by server to save the client some processing and help for SEO</li>
<li>if target is a script tag (of type=&quot;text/html&quot; or similar), then it is replaced with a div.</li>
</ul>
</li>
<li><p><em>Deprecated</em> <code>jtmpl(selector)</code>&mdash;returns an array, just a handy wrapper around <code>document.querySelectorAll</code>. Will remove this feature, as <code>jtmpl(string)</code> syntax will probably be used for something more consistent</p>
</li>
</ul>
<h3>Template specifics</h3>
<ul>
<li><p>limitation by design is the contents of each <a href="http://mustache.github.io/mustache.5.html">section</a> must be valid structural HTML, you cannot freely mix Mustache and HTML tags</p>
</li>
<li><p>variables are automatically enclosed in a <code>&lt;span&gt;</code> if they aren&#39;t HTML tag contents already</p>
</li>
<li><p>similarly, sections are automatically enclosed in a <code>&lt;div&gt;</code> if needed</p>
</li>
<li><p>and the same goes for section items</p>
</li>
<li><p><code>data-jt</code> attributes containing metadata for <code>Stage2</code> are injected in HTML elements</p>
</li>
<li><p><code>Stage1</code> also emits section structures (with changed delimiters) embedded in HTML comments</p>
</li>
<li><p>partials are not currently supported, plans are to support id-based and URL-based partials</p>
</li>
</ul>
<h3>Interpretation of patterns</h3>
<ul>
<li><p><code>&lt;tag&gt;{{var}}&lt;/tag&gt;</code>&mdash;Whenever <code>var</code> changes, <code>tag.innerHTML</code> changes</p>
</li>
<li><p><code>&lt;tag prop=&quot;{{var}}&quot;</code>&mdash;If <code>var</code> is null property is absent, otherwise equals <code>var</code></p>
</li>
<li><p><code>&lt;tag prop=&quot;{{bool_var}}&quot;</code>&mdash;If <code>bool_var</code> is true property is present, otherwise absent</p>
</li>
<li><p><code>&lt;tag class=&quot;{{class-name}} other-classes&quot;&gt;</code>&mdash;<code>class-name</code> is expected to be boolean indicating if <code>tag</code> currently has this class</p>
</li>
<li><p><code>&lt;tag value=&quot;{{var}}&quot;&gt;</code>&mdash;When <code>var</code> changes <code>tag.value</code> changes and vice versa</p>
</li>
<li><p><code>&lt;tag&gt;&lt;!-- {{var}} --&gt;&lt;/tag&gt;</code>&mdash;HTML comment is stripped when it contains one Mustache tag. This allows you to build easily templates that are valid HTML</p>
</li>
<li><p><code>&lt;tag onevent=&quot;{{handler}}&quot;&gt;</code>&mdash;<code>on</code>-prefixed properties are event handlers. <code>handler</code> is expected to be a function, <code>this</code> is the <code>model</code>. No need to add <code>onchange</code> handlers, DOM element values and <code>model</code> are already synced.</p>
</li>
<li><p><code>&lt;tag&gt; {{#section}}...{{/section}} &lt;/tag&gt;</code>&mdash;Whenever <code>section[i]</code> changes corresponding HTML element changes (you can insert or delete items via <code>Array.splice()</code> and only affected DOM elements are updated). There are no restrictions on the nesting level.</p>
</li>
</ul>
<h2>Kitchen Sink</h2>
<p>Showcase of all features, tests</p>
<p><a href="kitchensink.html">Link to example</a></p>
<pre><code>$ kitchensink.html

&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;css/baseline.css&quot;&gt;
    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;css/qunit.css&quot;&gt;
    &lt;style&gt;
        h2, h3 {margin-top: 64px}
        body {padding: 1% 7%; color:#586e75}
        .bound-class {
            color:red;
            -webkit-transition:color 0.5s ease-in;  
            -moz-transition:color 0.5s ease-in;  
            -o-transition:color 0.5s ease-in;  
            transition:color 0.5s ease-in;
        }
    &lt;/style&gt;
    &lt;script src=&quot;js/qunit.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;js/jtmpl.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;script id=&quot;kitchensink&quot; type=&quot;text/jtmpl&quot;&gt;

        &lt;h1&gt;Kitchen Sink&lt;/h1&gt;
        &lt;h2&gt;Feature explorer&lt;/h2&gt;
        &lt;a href=#qunit&gt;Tests&lt;/a&gt;
        &lt;p&gt;
            Feel free to modify &lt;code&gt;model&lt;/code&gt; from JS console and observe changes.
        &lt;/p&gt;

        &lt;h3&gt;Nested collections&amp;mdash;&lt;code&gt;model.collection&lt;/code&gt;&lt;/h3&gt;
        &lt;ul class=&quot;dummy-class just for the_test&quot;&gt;
            {{#collection}}
            &lt;li&gt;
                &lt;h4&gt;&lt;code&gt;model.collection[i].inner&lt;/code&gt;&lt;/h4&gt;
                &lt;ul&gt;
                    {{#inner}}&lt;li&gt;{{.}}&lt;/li&gt;{{/inner}}
                    {{^inner}}&lt;li&gt;&amp;lt; empty &amp;gt;&lt;/li&gt;{{/inner}}
                &lt;/ul&gt;
                &amp;nbsp;
                &lt;button onclick={{innerPush}}&gt;push&lt;/button&gt;
                &lt;button onclick=&quot;{{innerPop}}&quot; disabled={{popDisabled}}&gt;pop&lt;/button&gt;
            &lt;/li&gt;
            {{/collection}}
            {{^collection}}
            &lt;li&gt;&amp;lt; empty &amp;gt;&lt;/li&gt;
            {{/collection}}
        &lt;/ul&gt;
        &lt;br&gt;
        &lt;button onclick={{push}}&gt;push&lt;/button&gt;
        &lt;button onclick=&quot;{{pop}}&quot; disabled={{popDisabled}}&gt;pop&lt;/button&gt;

        &lt;h3&gt;Toggle text&amp;mdash;&lt;code&gt;model.text&lt;/code&gt;&lt;/h3&gt;
        &lt;a href=&quot;#&quot; onclick=&#39;{{toggle}}&#39;&gt;Toggle&lt;/a&gt;
        &lt;p&gt;
            {{text}}
        &lt;/p&gt;

        &lt;h3&gt;innerHTML&amp;mdash;&lt;code&gt;model.innerHTML&lt;/code&gt;&lt;/h3&gt;
        &lt;div&gt;&lt;!-- {{{innerHTML}}} --&gt;&lt;/div&gt;
        &lt;!-- `jtmpl` accepts tags in HTML comments and automatically strips them --&gt;

        &lt;h3&gt;Data binding&amp;mdash;&lt;code&gt;model.field&lt;/code&gt;&lt;/h3&gt;
        &lt;label for=&quot;field&quot;&gt;Enter something&lt;/label&gt; &lt;input id=&quot;field&quot; value={{field}}&gt;
        &lt;p&gt;
            {{#field}}
            You entered &quot;{{field}}&quot;. Delete it and this message will disappear
            {{/field}}
        &lt;/p&gt;

        &lt;h3&gt;Data binding, toggle class&amp;mdash;&lt;code&gt;model[&#39;bound-class&#39;]&lt;/code&gt;&lt;/h3&gt;
        &lt;div&gt;
            &lt;a href=# class=&quot;try2confuse-the_parser {{bound-class}}&quot; onclick=&quot;{{toggleClass}}&quot;&gt;Toggle .bound-class on me&lt;/a&gt;
        &lt;/div&gt;

        &lt;h3&gt;Checkboxes&amp;mdash;&lt;code&gt;model.checkboxes&lt;/code&gt;&lt;/h3&gt;
        {{#checkboxes}}
            &lt;label&gt;&lt;input type=&quot;checkbox&quot; checked={{fooCheck}}&gt; check foo&lt;/label&gt;
            &lt;label&gt;&lt;input type=&quot;checkbox&quot; checked={{barCheck}}&gt; check bar&lt;/label&gt;
        {{/checkboxes}}

        &lt;h3&gt;Select&amp;mdash;&lt;code&gt;model.options&lt;/code&gt;&lt;/h3&gt;
        &lt;select&gt;
            {{#options}}
            &lt;option selected={{checked}}&gt;{{text}}&lt;/option&gt;
            {{/options}}
        &lt;/select&gt;

        &lt;h3&gt;Radio group&amp;mdash;&lt;code&gt;model.options&lt;/code&gt;&lt;/h3&gt;
        &lt;div&gt;
            {{#options}}
            &lt;label&gt;&lt;input type=&quot;radio&quot; name=&quot;radio-group&quot; checked={{checked}}&gt;{{text}}&lt;/label&gt;
            {{/options}}
        &lt;/div&gt;
    &lt;/script&gt;

    &lt;script&gt;
        model = {
            text: &#39;lowercase&#39;,

            collection: [
                { popDisabled: false, inner: [1, 2, 3] },
                { popDisabled: false, inner: [6, 7] },
                { popDisabled: false, inner: [8, 9, 10, 11] }
            ],

            popDisabled: false,

            field: &#39;&#39;,

            &#39;bound-class&#39;: true,

            toggleClass: function(e) {
                this[&#39;bound-class&#39;] = !this[&#39;bound-class&#39;];
                e.preventDefault();
            },

            innerHTML: &#39;&lt;p&gt;Hi, how are you?&lt;/p&gt;&#39;,

            options: [
                {
                    checked: false,
                    text: &#39;one&#39; 
                },
                {
                    checked: true,
                    text: &#39;two&#39;
                },
                {
                    checked: false,
                    text: &#39;three&#39;
                }
            ],

            checkboxes: {
                fooCheck: true,
                barCheck: false
            },


            // event handlers
            toggle: function(e) {
                this.text = this.text == &#39;lowercase&#39; ?
                    &#39;UPPERCASE&#39;: &#39;lowercase&#39;;
                e.preventDefault();
            },
            push: function() {
                this.collection.push({
                    popDisabled: true,
                    inner: []
                });
                this.popDisabled = false;
            },
            pop: function() {
                this.collection.pop();
                this.popDisabled = this.collection.length == 0;
            },
            innerPush: function() {
                this.inner.push(parseInt(Math.random() * 100));
                this.popDisabled = false;
            },
            innerPop: function() {
                this.inner.pop();
                this.popDisabled = this.inner.length == 0;
            }
        };

        jtmpl(&#39;#kitchensink&#39;, &#39;#kitchensink&#39;, model);
    &lt;/script&gt;

    &lt;h2&gt;QUnit Blackbox Tests&lt;/h2&gt;
    &lt;div id=&quot;qunit&quot;&gt;&lt;/div&gt;
    &lt;div id=&quot;qunit-fixture&quot;&gt;&lt;/div&gt;
    &lt;script src=&quot;js/tests.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>

        <footer>
            Copyright &copy; 2013 Atanas Minev, <a href="LICENSE">MIT license</a>
        </footer>
        <script src="js/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <script src="js/jtmpl.js"></script>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
          ga('create', 'UA-43285803-1', 'jtmpl.com');
          ga('send', 'pageview');
        </script>
    </body>
</html>