/*! jtmpl 28-08-2013 */
!function(){var a,b,c,d,e;e=this,e.jtmpl=function(a,d,e,f){var g,h,i,j,k,l,m,n,o,p;if(p=/^\#[\w-]+$/,"string"==typeof a&&"object"==typeof d&&void 0===e&&(f=e,e=d,d=a,a=null),"string"==typeof a&&a.match(p)&&(a=document.getElementById(a.substring(1))),!e||"object"!=typeof e)throw":( model should be object";return d.match&&d.match(p)&&(d=document.getElementById(d.substring(1)).innerHTML),n=function(a){return(a+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},f=f||{},f.delimiters=(f.delimiters||"{{ }}").split(" "),f.compiledDelimiters=(f.compiledDelimiters||"<<< >>>").split(" "),f.defaultSection=f.defaultSectionTag||"div",f.defaultSectionItem=f.defaultSectionItem||"div",f.defaultVar=f.defaultVar||"span",o=new RegExp(n(f.delimiters[0])+/(\{)?(\#|\^|\/)?([\w\.\-_]+)(\})?/.source+n(f.delimiters[1]),"g"),j=/(<\s*[\w-_]+)(?:\s+([\w-\{\}]*)(=)?(?:((?:"[^">]*"?)|(?:'[^'>]*'?)|[^\s>]+))?)*\s*(>)?\s*$/,l=/^(\s*<([\w-_]+))(?:(\s*data-jt="[^"]*)")?[^>]*>.*?<\/\2>\s*$/,i=function(a){return(null!=a&&a||"").toString().replace(/[&\"<>\\]/g,function(a){switch(a){case"&":return"&amp;";case"\\":return"\\\\";case'"':return'"';case"<":return"&lt;";case">":return"&gt;";default:return a}})},m=function(a){return[function(){switch(a[2]){case"/":return"end";case"#":return"section";case"^":return"inverted_section";case void 0:return"{"===a[1]?"unescaped_var":"var";default:throw":( internal error, tag "+a[0]}}(),a[3],a[0],(a[2]||"")+a[3]]},h=function(a,d,e,g){var k,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K;for(C=e||0,B="",E=w=A=null,a=a.replace(new RegExp("<!--\\s*("+o.source+")\\s*-->"),"$1"),a=a.replace(new RegExp('([\\w-_]+)="('+o.source+')"',"g"),"$1=$2"),a=a.replace(new RegExp("\\n\\s*("+o.source+")\\s*\\n","g"),"\n$1\n"),s=function(){return B+=a.slice(C,o.lastIndex-(t||"").length),C=o.lastIndex},v=function(a,b){return b=b||"",w[3]&&!w[5]&&w[2]+w[3]+b+a+b||a},q=function(){return h(a,d,C,F)},y=function(){var a,b,c;return b=w.index+w[1].length,c=""+v(u),(a=B.match(new RegExp("[\\s\\S]{"+b+'}(\\sdata-jt="([^"]*))"')))?(b+=a[1].length,B=""+B.slice(0,b)+(a[2].length&&" "||"")+c+B.slice(b)):B=""+B.slice(0,b)+' data-jt="'+c+'"'+B.slice(b),""},k=function(a){var b,c;return a=a.trim(),b=a.match(l),B+=b?(c=b[1].length+(b[3]&&b[3].length||0),""+a.slice(0,c)+(!b[3]&&' data-jt="."'||" .")+a.slice(c)):"<"+f.defaultSectionItem+' data-jt=".">'+a+"</"+f.defaultSectionItem+">"};E=o.exec(a);)switch(K=m(E),G=K[0],F=K[1],t=K[2],u=K[3],s(),w=B.match(j),G){case"end":if(F!==g)throw g?":( expected {{/"+g+"}}, got "+t:":( unexpected {{/"+F+"}}";return B;case"var":case"unescaped_var":if(H="."===F?d:d[F],r="unescaped_var"===G&&H||i(H),w)if(y(),"function"==typeof H)B=B.replace(/[\w-_]+=$/,"");else if("class"===w[2]){if("boolean"!=typeof H)throw""+F+" is not boolean";H&&(B+=F)}else w[3]&&!w[5]?null===H?B=B.replace(/[\w-_]+=$/,""):"boolean"==typeof H?B=B.replace(/[\w-_]+=$/,"")+(H&&w[2]||""):B+='"'+H+'"':B+=H;else B+="<"+f.defaultVar+' data-jt="'+u+'">'+r+"</"+f.defaultVar+">";break;case"section":case"inverted_section":if(w?y():F!==A&&(B+="<"+f.defaultSection+' data-jt="'+u+'">'),H=d[F],D=a.slice(C).match(new RegExp("([\\s\\S]*?)"+n(f.delimiters[0]+"/"+F+f.delimiters[1]))),!D)throw":( unclosed section "+t;if(D=D[1].trim().replace(new RegExp(n(f.delimiters[0]),"g"),f.compiledDelimiters[0]).replace(new RegExp(n(f.delimiters[1]),"g"),f.compiledDelimiters[1]),B+="<!-- "+E[2]+" "+D+" -->","section"===G)if(!H||b(H)&&!H.length)q(),C=o.lastIndex;else{for(p=b(H)&&H||[H],x=I=0,J=p.length;J>I;x=++I)z=p[x],k(h(a,c(H)?z:d,C,F)),x<p.length-1&&(o.lastIndex=C);C=o.lastIndex}else!H||b(H)&&!H.length?(B+=h(a,d,C,F),C=o.lastIndex):(q(d),C=o.lastIndex);w||F===A||(B+="</"+f.defaultSection+">"),A=F}return B+=a.slice(C),B=B.replace(/data-jt="\.(\s\.)+"/g,'data-jt="."')},k=h(d,e),a?(a.innerHTML=k,a.setAttribute("data-jt","."),g=function(a,b,c){var d,e,f,h,i,j,k,l,m,n,o,p,q,r,s;for(c=c||"",e=function(){},p=a.childNodes,s=[],l=0,n=p.length;n>l;l++)switch(i=p[l],i.nodeType){case i.ELEMENT_NODE:if(d=i.getAttribute("data-jt"))for(q=d.split(" "),m=0,o=q.length;o>m;m++)h=q[m],r=h.match(/(?:\/|#)?([\w-.]+)(?:\=([\w-.]+))?/),j=r[0],f=r[1],k=r[2],null==b._jt_model2dom&&(b._jt_model2dom=[]),b._jt_model2dom.push([f,k]);s.push(g(i,b,c+"    "));break;case i.TEXT_NODE:break;case i.COMMENT_NODE:break;default:throw":( unexpected nodeType "+i.nodeType}return s},g(a,e)):k},b=Array.isArray||function(a){return"[object Array]"==={}.toString.call(a)},c=function(a){return a&&"object"==typeof a},d=function(a,c,e){var f,g;if(null==c&&(c=0),null==e&&(e=2),c>e)return"<..>";switch(typeof a){case"string":return'"'+a.replace(/"/g,'\\"')+'"';case"function":return"function";case"object":return b(a)?"["+[function(){var b,g,h;for(h=[],b=0,g=a.length;g>b;b++)f=a[b],h.push(""+d(f,c+1,e));return h}()]+"]":"{"+[function(){var b,f,h,i;for(h=a.keys(),i=[],b=0,f=h.length;f>b;b++)g=h[b],i.push(""+g+":"+d(a[g],c+1,e));return i}()]+"}";case"undefined":return"undefined";default:return a}},a=function(a){return Array.prototype.slice.call(document.querySelectorAll(a))},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")})}.call(this),Object.observe||function(a,b){var c=function(a){var c=a.call(a),d=typeof d;return"object"==typeof b.alert?function(b){return c===a.call(b)||!!b&&typeof b.toString==d&&typeof b.valueOf==d&&/^\s*\bfunction\b/.test(""+b)}:function(b){return c===a.call(b)}}(a.prototype.toString),d=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},e=function(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b},f=function(a){return"undefined"==typeof a?!1:"get"in a||"set"in a},g=function(a,b){if("object"!=typeof a)throw new TypeError("Object.observeObject called on non-object");if(c(b)===!1)throw new TypeError("Object.observeObject: Expecting function");if(Object.isFrozen(b)===!0)throw new TypeError("Object.observeObject: Expecting unfrozen function")},h=function(){var a=[],b=function(b,c){g(b,c),Object.getNotifier(b).addListener(c),-1===a.indexOf(b)?a.push(b):Object.getNotifier(b)._checkPropertyListing()};b.prototype.deliverChangeRecords=function(a){Object.getNotifier(a).deliverChangeRecords()},a.lastScanned=0;var c=function(a){return function(){var b=0,d=a.length,e=new Date,f=!1;for(b=a.lastScanned;d>b&&!f;b++)Object.getNotifier(a[b])._checkPropertyListing(),f=new Date-e>100;a.lastScanned=d>b?b:0,setTimeout(c,100)}}(a);return setTimeout(c,100),b}(),i=function(a){var b=[],c=[],g=!1,h=[],i=[],j=this;Object.defineProperty(j,"_watching",{get:function(a){return function(){return a}}(a)});var k=function(a,b){var c=(typeof a[b],Object.getOwnPropertyDescriptor(a,b));if("getNotifier"===b||f(c)||!c.enumerable)return!1;if(a instanceof Array&&d(b)){var g=h.length;return h[g]=b,i[g]=a[b],!0}return function(b,c){h[b]=c,i[b]=a[c],Object.defineProperty(a,c,{get:function(){return i[b]},set:function(d){e(i[b],d)||(Object.getNotifier(a).queueUpdate(a,c,"updated",i[b]),i[b]=d)}})}(h.length,b),!0};j._checkPropertyListing=function(a){var b,c,e,f,g=j._watching,l=Object.keys(g),m=0,n=l.length,o=h.slice(0),p=!a;for(m=0;n>m;m++)b=l[m],e=g[b],c=typeof e,-1===(f=h.indexOf(b))?k(g,b)&&p&&j.queueUpdate(g,b,"new",null,g[b]):(g instanceof Array&&d(b)&&i[f]!==e&&(p&&j.queueUpdate(g,b,"updated",i[f],e),i[f]=e),o.splice(o.indexOf(b),1));if(p)for(n=o.length,m=0;n>m;m++)f=h.indexOf(o[m]),j.queueUpdate(g,o[m],"deleted",i[f]),h.splice(f,1),i.splice(f,1)},j.addListener=function(a){var c=b.indexOf(a);-1===c&&b.push(a)},j.removeListener=function(a){var c=b.indexOf(a);c>-1&&b.splice(c,1)},j.listeners=function(){return b},j.queueUpdate=function(a,b,c,d){this.queueUpdates([{type:c,object:a,name:b,oldValue:d}])},j.queueUpdates=function(a){var b,d=this,e=0,f=a.length||0;for(e=0;f>e;e++)b=a[e],c.push(b);g&&clearTimeout(g),g=setTimeout(function(){g=!1,d.deliverChangeRecords()},100)},j.deliverChangeRecords=function(){var a=0,d=b.length,e=!0;for(a=0;d>a&&e;a++)"function"==typeof b[a]&&(b[a]===console.log?console.log(c):e=!b[a](c));c=[]},j._checkPropertyListing(!0)},j=[],k=[];a.getNotifier=function(a){var b=k.indexOf(a),c=b>-1?j[b]:!1;return c||(b=k.length,k[b]=a,c=j[b]=new i(a)),c},a.observe=function(a,b){return new h(a,b)},a.unobserve=function(b,c){g(b,c),a.getNotifier(b).removeListener(c)}}(Object,this);