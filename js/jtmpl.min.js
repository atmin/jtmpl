/*! jtmpl 15-08-2013 */
function jtmpl(el,tpl,model){var target,self;return self={re:/{{({)?(\#|\^|\/)?([\w\.]+)(})?}}/g,tpl:tpl,model:model,tags:[],_get:function(v,context){return context=context||self.model,eval("context"+("."===v?"":"."+v))},_build:function(a,b,c,d){var e,f,g,h,i,j="",k=function(b){j+=void 0!==b?b:a.slice(c,self.re.lastIndex-f[0].length)},l=function(a){(d?self.tags[self.tags.length-1].children:self.tags).push(a)};for(c=c||0,f=self.re.exec(a);f;){if("/"===f[2]){if(d&&f[3]!==d[3])throw err="Expected {{/"+d[3]+"}}, got "+f[0],console.log(err),err;return k(),j}if(f[2]||(k(),k(self._get(f[3],b)||""),c=self.re.lastIndex,l({type:"var",value:self._get(f[3],b)})),"#"===f[2]||"^"===f[2])if(g=self._get(f[3],b),l({type:"block",neg:"^"===f[2],children:[]}),g)if(g&&"#"===f[2]){for(k(),0===g.length&&self._build(a,g[h],c,f),i="[object Array]"!==Object.prototype.toString.call(g)?[g]:g,c=self.re.lastIndex,h=0;h<i.length;h++)k(),c=self.re.lastIndex,k(self._build(a,"object"==typeof g?i[h]:b,c,f)),h<i.length-1&&(self.re.lastIndex=c);c=self.re.lastIndex}else{if(!g||void 0===typeof g.length||"^"!=f[2])throw"Internal error, tag "+f[0];k(),c=self.re.lastIndex,e=self._build(a,b,c,f),c=self.re.lastIndex,k(g.length?"":e)}else k(),e=self._build(a,g,self.re.lastIndex,f),c=self.re.lastIndex,k("#"===f[2]?"":e);f=self.re.exec(a)}if(d)throw"Unclosed tag "+d[0];return j+a.slice(c)},_attachEventHandlers:function(){},_modelObserver:function(a){a.forEach(function(a){console.log(a.name+" was "+a.type+" and is now "+a.object[a.name])})}},void 0===tpl?document.getElementById(el.substring(1))._jtmpl:(self.html=self._build(tpl.match(/\#\w+/)?document.getElementById(tpl.substring(1)).innerHTML:tpl,model),Object.observe(model,self._modelObserver),target=document.getElementById(el.substring(1)),target._jtmpl=self,target.innerHTML=self.html,self)}Object.observe||function(a,b){var c=function(a){var c=a.call(a),d=typeof d;return"object"==typeof b.alert?function(b){return c===a.call(b)||!!b&&typeof b.toString==d&&typeof b.valueOf==d&&/^\s*\bfunction\b/.test(""+b)}:function(b){return c===a.call(b)}}(a.prototype.toString),d=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},e=function(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b},f=function(a){return"undefined"==typeof a?!1:"get"in a||"set"in a},g=function(a,b){if("object"!=typeof a)throw new TypeError("Object.observeObject called on non-object");if(c(b)===!1)throw new TypeError("Object.observeObject: Expecting function");if(Object.isFrozen(b)===!0)throw new TypeError("Object.observeObject: Expecting unfrozen function")},h=function(){var a=[],b=function(b,c){g(b,c),Object.getNotifier(b).addListener(c),-1===a.indexOf(b)?a.push(b):Object.getNotifier(b)._checkPropertyListing()};b.prototype.deliverChangeRecords=function(a){Object.getNotifier(a).deliverChangeRecords()},a.lastScanned=0;var c=function(a){return function(){var b=0,d=a.length,e=new Date,f=!1;for(b=a.lastScanned;d>b&&!f;b++)Object.getNotifier(a[b])._checkPropertyListing(),f=new Date-e>100;a.lastScanned=d>b?b:0,setTimeout(c,100)}}(a);return setTimeout(c,100),b}(),i=function(a){var b=[],c=[],g=!1,h=[],i=[],j=this;Object.defineProperty(j,"_watching",{get:function(a){return function(){return a}}(a)});var k=function(a,b){var c=(typeof a[b],Object.getOwnPropertyDescriptor(a,b));if("getNotifier"===b||f(c)||!c.enumerable)return!1;if(a instanceof Array&&d(b)){var g=h.length;return h[g]=b,i[g]=a[b],!0}return function(b,c){h[b]=c,i[b]=a[c],Object.defineProperty(a,c,{get:function(){return i[b]},set:function(d){e(i[b],d)||(Object.getNotifier(a).queueUpdate(a,c,"updated",i[b]),i[b]=d)}})}(h.length,b),!0};j._checkPropertyListing=function(a){var b,c,e,f,g=j._watching,l=Object.keys(g),m=0,n=l.length,o=h.slice(0),p=!a;for(m=0;n>m;m++)b=l[m],e=g[b],c=typeof e,-1===(f=h.indexOf(b))?k(g,b)&&p&&j.queueUpdate(g,b,"new",null,g[b]):(g instanceof Array&&d(b)&&i[f]!==e&&(p&&j.queueUpdate(g,b,"updated",i[f],e),i[f]=e),o.splice(o.indexOf(b),1));if(p)for(n=o.length,m=0;n>m;m++)f=h.indexOf(o[m]),j.queueUpdate(g,o[m],"deleted",i[f]),h.splice(f,1),i.splice(f,1)},j.addListener=function(a){var c=b.indexOf(a);-1===c&&b.push(a)},j.removeListener=function(a){var c=b.indexOf(a);c>-1&&b.splice(c,1)},j.listeners=function(){return b},j.queueUpdate=function(a,b,c,d){this.queueUpdates([{type:c,object:a,name:b,oldValue:d}])},j.queueUpdates=function(a){var b,d=this,e=0,f=a.length||0;for(e=0;f>e;e++)b=a[e],c.push(b);g&&clearTimeout(g),g=setTimeout(function(){g=!1,d.deliverChangeRecords()},100)},j.deliverChangeRecords=function(){var a=0,d=b.length,e=!0;for(a=0;d>a&&e;a++)"function"==typeof b[a]&&(b[a]===console.log?console.log(c):e=!b[a](c));c=[]},j._checkPropertyListing(!0)},j=[],k=[];a.getNotifier=function(a){var b=k.indexOf(a),c=b>-1?j[b]:!1;return c||(b=k.length,k[b]=a,c=j[b]=new i(a)),c},a.observe=function(a,b){return new h(a,b)},a.unobserve=function(b,c){g(b,c),a.getNotifier(b).removeListener(c)}}(Object,this);