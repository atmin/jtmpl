/*! jtmpl 30-08-2013 */
!function(){var a;a=this,a.jtmpl=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(q=/^\#[\w-]+$/,"string"==typeof a&&null==b){if("undefined"==typeof document||null===document)throw":( this API is only available in a browser";return Array.prototype.slice.call(document.querySelectorAll(a))}if("string"==typeof a&&"object"==typeof b&&void 0===c&&(d=c,c=b,b=a,a=null),"string"==typeof a&&a.match(q)&&(a=document.getElementById(a.substring(1))),!c||"object"!=typeof c)throw":( model should be object";return b.match&&b.match(q)&&(b=document.getElementById(b.substring(1)).innerHTML),o=function(a){return(a+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},d=d||{},d.delimiters=(d.delimiters||"{{ }}").split(" "),d.compiledDelimiters=(d.compiledDelimiters||"<<< >>>").split(" "),d.defaultSection=d.defaultSectionTag||"div",d.defaultSectionItem=d.defaultSectionItem||"div",d.defaultVar=d.defaultVar||"span",s=/(\{)?(\#|\^|\/)?([\w\.\-_]+)(\})?/,p=new RegExp(o(d.delimiters[0])+s.source+o(d.delimiters[1]),"g"),k=/(<\s*[\w-_]+)(?:\s+([\w-\{\}]*)(=)?(?:((?:"[^">]*"?)|(?:'[^'>]*'?)|[^\s>]+))?)*\s*(>)?\s*$/,m=/^(\s*<([\w-_]+))(?:(\s*data-jt="[^"]*)")?[^>]*>.*?<\/\2>\s*$/,i=function(a){return(null!=a&&a||"").toString().replace(/[&\"<>\\]/g,function(a){switch(a){case"&":return"&amp;";case"\\":return"\\\\";case'"':return'"';case"<":return"&lt;";case">":return"&gt;";default:return a}})},n=function(a){return[function(){switch(a[2]){case"/":return"end";case"#":return"section";case"^":return"inverted_section";case void 0:return"{"===a[1]?"unescaped_var":"var";default:throw":( internal error, tag "+a[0]}}(),a[3],a[0],(a[2]||"")+a[3]]},f=function(a,b,c){return b.addEventListener?b.addEventListener(a,c,!1):b.attachEvent?b.attachEvent("on"+a,c):b[a]=c},j=function(a,b){return new RegExp("(\\s|^)"+b+"(\\s|$)").test(a.className)},e=function(a,b){return j(a,b)?void 0:a.className+=(a.className&&" "||"")+b},r=function(a,b){return j(a,b)?a.className=a.className.replace(new RegExp("(\\s|^)"+b+"(\\s|$)"),"").replace(/^\s+|\s+$/g,""):void 0},h=function(a,b,c,e){var f,g,j,l,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I;for(A=c||0,z="",C=u=y=null,a=a.replace(new RegExp("<!--\\s*("+p.source+")\\s*-->"),"$1"),a=a.replace(new RegExp('([\\w-_]+)="('+p.source+')"',"g"),"$1=$2"),a=a.replace(new RegExp("\\n\\s*("+p.source+")\\s*\\n","g"),"\n$1\n"),q=function(){return z+=a.slice(A,p.lastIndex-(r||"").length),A=p.lastIndex},t=function(a,b){return b=b||"",u[3]&&!u[5]&&u[2]+u[3]+b+a+b||a},j=function(){return h(a,b,A,D)},w=function(){var a,b,c;return b=u.index+u[1].length,c=""+t(s),(a=z.match(new RegExp("[\\s\\S]{"+b+'}(\\sdata-jt="([^"]*))"')))?(b+=a[1].length,z=""+z.slice(0,b)+(a[2].length&&" "||"")+c+z.slice(b)):z=""+z.slice(0,b)+' data-jt="'+c+'"'+z.slice(b),""},f=function(a){var b,c;return a=a.trim(),b=a.match(m),z+=b?(c=b[1].length+(b[3]&&b[3].length||0),""+a.slice(0,c)+(!b[3]&&' data-jt="."'||" .")+a.slice(c)):"<"+d.defaultSectionItem+' data-jt=".">'+a+"</"+d.defaultSectionItem+">"};C=p.exec(a);)switch(I=n(C),E=I[0],D=I[1],r=I[2],s=I[3],q(),u=z.match(k),E){case"end":if(D!==e)throw e?":( expected {{/"+e+"}}, got "+r:":( unexpected {{/"+D+"}}";return z;case"var":case"unescaped_var":if(F="."===D?b:b[D],l="unescaped_var"===E&&F||i(F),u)if(w(),"function"==typeof F)z=z.replace(/[\w-_]+=$/,"");else if("class"===u[2]){if("boolean"!=typeof F)throw""+D+" is not boolean";F&&(z+=D)}else u[3]&&!u[5]?null===F?z=z.replace(/[\w-_]+=$/,""):"boolean"==typeof F?z=z.replace(/[\w-_]+=$/,"")+(F&&u[2]||""):z+='"'+F+'"':z+=F;else z+="<"+d.defaultVar+' data-jt="'+s+'">'+l+"</"+d.defaultVar+">";break;case"section":case"inverted_section":if(u?w():D!==y&&(z+="<"+d.defaultSection+' data-jt="'+s+'">'),F=b[D],B=a.slice(A).match(new RegExp("([\\s\\S]*?)"+o(d.delimiters[0]+"/"+D+d.delimiters[1]))),!B)throw":( unclosed section "+r;if(B=B[1].trim().replace(new RegExp(o(d.delimiters[0]),"g"),d.compiledDelimiters[0]).replace(new RegExp(o(d.delimiters[1]),"g"),d.compiledDelimiters[1]),z+="<!-- "+C[2]+" "+B+" -->","section"===E)if(!F||Array.isArray(F)&&!F.length)j(),A=p.lastIndex;else{for(g=Array.isArray(F)&&F||[F],v=G=0,H=g.length;H>G;v=++G)x=g[v],f(h(a,F&&"object"==typeof F?x:b,A,D)),v<g.length-1&&(p.lastIndex=A);A=p.lastIndex}else{if("inverted_section"!==E)throw":( internal error";!F||Array.isArray(F)&&!F.length?(z+=h(a,b,A,D),A=p.lastIndex):(j(b),A=p.lastIndex)}u||D===y||(z+="</"+d.defaultSection+">"),y=D}return z+=a.slice(A),z=z.replace(/data-jt="\.(\s\.)+"/g,'data-jt="."')},l=h(b,c),a?(a.innerHTML=l,a.setAttribute("data-jt","."),g=function(a,b){var c,d,h,i,j,k,l,m,n,o,p,q,s,t,u,v,w,x,y,z,A,B,C;for(q=function(){},i=function(){},k=function(a){return function(b){var c,d,e,f;for(f=[],d=0,e=b.length;e>d;d++)c=b[d],c.name===a&&"updated"===c.type?f.push(this.innerHTML=c.object[a]):f.push(void 0);return f}},h=function(a){return function(b){var c,d,f,g;for(g=[],d=0,f=b.length;f>d;d++)c=b[d],c.name===a&&"updated"===c.type?g.push((c.object[a]&&e||r)(this,a)):g.push(void 0);return g}},d=function(a,b){return function(c){var d,e,f,g;for(g=[],e=0,f=c.length;f>e;e++)d=c[e],d.name===b&&"updated"===d.type?g.push(this.setAttribute(a,d.object[b])):g.push(void 0);return g}},l=0,p=null,y=a.childNodes,C=[],u=0,w=y.length;w>u;u++)switch(o=y[u],o.nodeType){case o.ELEMENT_NODE:if(c=o.getAttribute("data-jt"))for(z=c.trim().split(" "),v=0,x=z.length;x>v;v++)if(m=z[v],"#"===(A=m.slice(0,1))||"^"===A)p=b[m.slice(1)],Object.observe(p||b,q.bind(o));else if("."===m)p=b[l++],"object"!=typeof p&&(p=null);else if(B=m.match(/(?:\/|#)?([\w-.]+)(?:\=([\w-.]+))?/),s=B[0],n=B[1],t=B[2],n&&0===n.indexOf("on")){if(j=b[t],"function"!=typeof j)throw":( "+t+" is not a function, cannot attach event handler";f(n.slice(2),o,j.bind(b))}else t?"class"===n?Object.observe(b,h(t).bind(o)):Object.observe(b,d(n,t).bind(o)):Object.observe(b,k(n).bind(o));C.push(g(o,p||b));break;case o.TEXT_NODE:break;case o.COMMENT_NODE:break;default:throw":( unexpected nodeType "+o.nodeType}return C},g(a,c)):l}}.call(this),Object.observe||function(a,b){var c=function(a){var c=a.call(a),d=typeof d;return"object"==typeof b.alert?function(b){return c===a.call(b)||!!b&&typeof b.toString==d&&typeof b.valueOf==d&&/^\s*\bfunction\b/.test(""+b)}:function(b){return c===a.call(b)}}(a.prototype.toString),d=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},e=function(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b},f=function(a){return"undefined"==typeof a?!1:"get"in a||"set"in a},g=function(a,b){if("object"!=typeof a)throw new TypeError("Object.observeObject called on non-object");if(c(b)===!1)throw new TypeError("Object.observeObject: Expecting function");if(Object.isFrozen(b)===!0)throw new TypeError("Object.observeObject: Expecting unfrozen function")},h=function(){var a=[],b=function(b,c){g(b,c),Object.getNotifier(b).addListener(c),-1===a.indexOf(b)?a.push(b):Object.getNotifier(b)._checkPropertyListing()};b.prototype.deliverChangeRecords=function(a){Object.getNotifier(a).deliverChangeRecords()},a.lastScanned=0;var c=function(a){return function(){var b=0,d=a.length,e=new Date,f=!1;for(b=a.lastScanned;d>b&&!f;b++)Object.getNotifier(a[b])._checkPropertyListing(),f=new Date-e>100;a.lastScanned=d>b?b:0,setTimeout(c,100)}}(a);return setTimeout(c,100),b}(),i=function(a){var b=[],c=[],g=!1,h=[],i=[],j=this;Object.defineProperty(j,"_watching",{get:function(a){return function(){return a}}(a)});var k=function(a,b){var c=(typeof a[b],Object.getOwnPropertyDescriptor(a,b));if("getNotifier"===b||f(c)||!c.enumerable)return!1;if(a instanceof Array&&d(b)){var g=h.length;return h[g]=b,i[g]=a[b],!0}return function(b,c){h[b]=c,i[b]=a[c],Object.defineProperty(a,c,{get:function(){return i[b]},set:function(d){e(i[b],d)||(Object.getNotifier(a).queueUpdate(a,c,"updated",i[b]),i[b]=d)}})}(h.length,b),!0};j._checkPropertyListing=function(a){var b,c,e,f,g=j._watching,l=Object.keys(g),m=0,n=l.length,o=h.slice(0),p=!a;for(m=0;n>m;m++)b=l[m],e=g[b],c=typeof e,-1===(f=h.indexOf(b))?k(g,b)&&p&&j.queueUpdate(g,b,"new",null,g[b]):(g instanceof Array&&d(b)&&i[f]!==e&&(p&&j.queueUpdate(g,b,"updated",i[f],e),i[f]=e),o.splice(o.indexOf(b),1));if(p)for(n=o.length,m=0;n>m;m++)f=h.indexOf(o[m]),j.queueUpdate(g,o[m],"deleted",i[f]),h.splice(f,1),i.splice(f,1)},j.addListener=function(a){var c=b.indexOf(a);-1===c&&b.push(a)},j.removeListener=function(a){var c=b.indexOf(a);c>-1&&b.splice(c,1)},j.listeners=function(){return b},j.queueUpdate=function(a,b,c,d){this.queueUpdates([{type:c,object:a,name:b,oldValue:d}])},j.queueUpdates=function(a){var b,d=this,e=0,f=a.length||0;for(e=0;f>e;e++)b=a[e],c.push(b);g&&clearTimeout(g),g=setTimeout(function(){g=!1,d.deliverChangeRecords()},100)},j.deliverChangeRecords=function(){var a=0,d=b.length,e=!0;for(a=0;d>a&&e;a++)"function"==typeof b[a]&&(b[a]===console.log?console.log(c):e=!b[a](c));c=[]},j._checkPropertyListing(!0)},j=[],k=[];a.getNotifier=function(a){var b=k.indexOf(a),c=b>-1?j[b]:!1;return c||(b=k.length,k[b]=a,c=j[b]=new i(a)),c},a.observe=function(a,b){return new h(a,b)},a.unobserve=function(b,c){g(b,c),a.getNotifier(b).removeListener(c)}}(Object,this);