!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;"undefined"!=typeof window?n=window:"undefined"!=typeof global?n=global:"undefined"!=typeof self&&(n=self),n.jtmpl=e()}}(function(){var define,module,exports;return function e(n,t,r){function o(c,l){if(!t[c]){if(!n[c]){var a="function"==typeof require&&require;if(!l&&a)return a(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+c+"'")}var u=t[c]={exports:{}};n[c][0].call(u.exports,function(e){var t=n[c][1][e];return o(t?t:e)},u,u.exports,e,n,t,r)}return t[c].exports}for(var i="function"==typeof require&&require,c=0;c<r.length;c++)o(r[c]);return o}({1:[function(e,n){function t(e){if(!(this instanceof t))return new t(e);e||(e={}),e.nodeType&&(e={el:e}),this.opts=e,this.el=e.el||document.body,"object"!=typeof this.el&&(this.el=document.querySelector(this.el))}n.exports=function(e){return new t(e)},t.prototype.add=function(e){var n=this.el;if(n){if(""===n.className)return n.className=e;var t=n.className.split(" ");return t.indexOf(e)>-1?t:(t.push(e),n.className=t.join(" "),t)}},t.prototype.remove=function(e){var n=this.el;if(n&&""!==n.className){var t=n.className.split(" "),r=t.indexOf(e);return r>-1&&t.splice(r,1),n.className=t.join(" "),t}},t.prototype.has=function(e){var n=this.el;if(n){var t=n.className.split(" ");return t.indexOf(e)>-1}}},{}],2:[function(e,n){"use strict";function t(e,n,r,o){function i(e,n){if(!e)throw n||"assertion failed"}function c(e,n){for(var t=0,r=Object.getOwnPropertyNames(n),o=r.length;o>t;t++)e[r[t]]=n[r[t]]}function l(e,n){if("object"==typeof e&&null!==e&&"object"==typeof n&&null!==n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(var t in e){if(!n.hasOwnProperty(t))return!1;if(!l(e[t],n[t]))return!1}return!0}return e!==n?!1:!0}function a(){var e=arguments[0],n=["string","number"].indexOf(typeof arguments[1])>-1?arguments[1]:null,t="function"==typeof arguments[1]?arguments[1]:"function"==typeof arguments[2]?arguments[2]:null;i(["change","update","insert","delete"].indexOf(e)>-1),i(["change"].indexOf(e)>-1&&null!==n||["insert","delete","update"].indexOf(e)>-1&&null===n),y[e][n]||(y[e][n]=[]),-1===y[e][n].indexOf(t)&&y[e][n].push(t)}function u(){var e,n=arguments[0],t="string"==typeof arguments[1]?arguments[1]:null,r="function"==typeof arguments[1]?arguments[1]:"function"==typeof arguments[2]?arguments[2]:null;y[n][t]&&(r?(e=y[n][t].indexOf(r),e>-1&&y[n][t].splice(e,1)):y[n][t]=[])}function s(e,n,t){(y[e][["change"].indexOf(e)>-1?n:null]||[]).map(function(e){e.call(_,n,t)})}function d(e){l(E[e],p(e))||s("change",e);for(var n=0,t=N[e]||[],r=t.length;r>n;n++)delete x[t[n]],_.trigger("update",t[n]);_.parent&&_.parent.trigger("update",_.prop,e)}function f(e){return function(n,t){return N[n]||(N[n]=[]),-1===N[n].indexOf(e)&&N[n].push(e),g(n,t)}}function p(n,t){var r=e[n];return E[n]="function"==typeof r?r.call(f(n),t):r}function m(e,r){var o=p(e,r);return o&&"object"==typeof o?x[e]?x[e]:x[e]=t(o,n||_,_,e):o}function h(n,t){var r=p(n);"function"==typeof e[n]?e[n].call(f(n),t):(e[n]=t,t&&"object"==typeof t&&delete E[n]),r!==t&&s("update",n)}function g(e,n){return(void 0===n||"function"==typeof n?m:h)(e,n)}function v(n,t){return function(){var r=[][n].apply(e,arguments);return this.len=this.values.length,t.apply(this,arguments),_.parent.trigger("update",_.prop),r}}var y={change:{},update:{},insert:{},delete:{}},N={},E={},x={},_=function(){return g.apply(null,arguments)};return c(_,{values:e,parent:r||null,root:n||_,prop:void 0===o?null:o,on:a,off:u,trigger:s}),Array.isArray(e)&&c(_,{len:e.length,pop:v("pop",function(){s("delete",this.len,1)}),push:v("push",function(){s("insert",this.len-1,1)}),reverse:v("reverse",function(){E={},s("delete",0,this.len),s("insert",0,this.len)}),shift:v("shift",function(){E={},s("delete",0,1)}),unshift:v("unshift",function(){E={},s("insert",0,1)}),sort:v("sort",function(){E={},s("delete",0,this.len),s("insert",0,this.len)}),splice:v("splice",function(){E={},arguments[1]&&s("delete",arguments[0],arguments[1]),arguments.length>2&&s("insert",arguments[0],arguments.length-2)})}),a("update",d),_}"object"==typeof n&&(n.exports=t)},{}],3:[function(e,n){n.exports=function n(t,r,o){function i(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function c(e,n){return RegExp(i(e.delimiters[0])+"("+j.RE_ANYTHING+")"+i(e.delimiters[1]),n)}function l(n,t,r,o,i){var c,l,a=e("./rules"),u=a.length;for(n=n.slice(i.delimiters[0].length,-i.delimiters[1].length),c=0;u>c;c++)if(l=a[c](n,t,r,o,i))return l.index=c,l}function a(e,n){return e=e.replace(RegExp(i(n.delimiters[0]+"{")+j.RE_SRC_IDENTIFIER+i("}"+n.delimiters[1]),"g"),n.delimiters[0]+"&$1"+n.delimiters[1]),e=e.replace(c(n,"g"),function(n,t,r){var o=e.slice(0,r),i=!!o.match(RegExp("<"+j.RE_SRC_IDENTIFIER+"[^>]*?$")),c=!!o.match(/<!--\s*$/),l=0===t.indexOf("!");return i||c?l?"":n:"<!--"+n+"-->"})}function u(e,n,t){var r=n.match(RegExp(i(t.delimiters[0])+"\\/"+j.RE_SRC_IDENTIFIER+"?"+i(t.delimiters[1])));return r?""===e||void 0===r[1]||r[1]===e:!1}var s,d,f,p,m,h,g,v,y,N,E,x,_,R,I,b,O,T,D,j=e("./consts"),C=document.createDocumentFragment(),S=e("freak");for(o=o||e("./default-options"),r="function"==typeof r?r:S("object"==typeof r?r:{".":r}),t instanceof Node?_=t:(t=a(t,o),_=document.createElement("body"),_.innerHTML=t),s=0,d=_.childNodes,f=d.length;f>s;s++)switch(R=d[s],I=R.cloneNode(!1),C.appendChild(I),I.nodeType){case 1:for(I.__jtmpl__=r,p=0,m=I.attributes.length;m>p;p++){for(h=I.attributes[p],v=[],N="",g=h.value,b=c(o,"g");O=b.exec(g);)if(T=l(O[0],I,h.name,r,o)){if(v.push(T),T.block){for(D=O[0],E=O.index,x=O.index+O[0].length;O&&!u(T.block,O[0],o);O=b.exec(g));if(!O)throw"Unclosed"+D;N+=g.slice(0,E)+T.replace(h.value.slice(x,O.index))+g.slice(O.index+O[0].length)}T.block||void 0===T.replace||(h.value=T.replace)}for(v.length&&(h.value=N),y=0;y<v.length;y++)T=v[y],T.change&&(r.on("change",T.block||T.prop,T.change),T.change())}I.appendChild(n(R,r,o));break;case 8:if(u("",I.data,o))throw"jtmpl: Unexpected "+I.data;if((O=I.data.match(c(o)))&&(T=l(I.data,R,null,r,o))){if(T.replace instanceof Node&&I.parentNode.replaceChild(T.replace,I),T.block){for(D=document.createDocumentFragment(),s++;f>s&&!u(T.block,d[s].data||"",o);s++)D.appendChild(d[s].cloneNode(!0));if(s===f)throw"jtmpl: Unclosed "+I.data;I.parentNode.replaceChild(T.replace(D,I.parentNode),I)}T.prop&&T.change&&(r.on("change",T.prop,T.change),T.change())}}return C}},{"./consts":4,"./default-options":5,"./rules":8,freak:2}],4:[function(e,n){n.exports={RE_IDENTIFIER:/^[\w\.\-]+$/,RE_SRC_IDENTIFIER:"([\\w\\.\\-]+)",RE_PARTIAL:/>([\w\.\-]+)|'([^\']*)\'|"([^"]*)"/,RE_PIPE:/^[\w\.\-]+(?:\|[\w\.\-]+)?$/,RE_NODE_ID:/^#[\w\.\-]+$/,RE_ENDS_WITH_NODE_ID:/.+(#[\w\.\-]+)$/,RE_ANYTHING:"[\\s\\S]*?",RE_SPACE:"\\s*"}},{}],5:[function(e,n){n.exports={delimiters:["{{","}}"]}},{}],6:[function(_dereq_,module,exports){module.exports=function(target,src,model){function mixin(e,n){for(var t in n)0===t.indexOf("__")&&t.lastIndexOf("__")===t.length-2||"function"==typeof n[t]?void 0===e.values[t]&&(e.values[t]=n[t]):void 0===e(t)&&e(t,n[t])}function applyPlugins(){var e,n;for(e in jtmpl.plugins)plugin=jtmpl.plugins[e],n=model.values["__"+e+"__"],"function"==typeof plugin&&void 0!==n&&plugin.call(model,n,target)}function evalObject(body,src){var result,module={exports:{}};return src=src?"\n//@ sourceURL="+src+"\n//# sourceURL="+src:"",body.match(/^\s*{[\S\s]*}\s*$/)?eval("(function(){ var result="+body+"; return result})()"+src):eval("(function(module, exports){"+body+";return module.exports})"+src)(module,module.exports)}function loadModel(e,n,t){if(e)if(e.match(consts.RE_NODE_ID)){var r=t.querySelector(e);mixin(model,evalObject(r.innerHTML,e)),applyPlugins(),jtmpl(target,n,model)}else jtmpl("GET",e,function(t){var r=e.match(consts.RE_ENDS_WITH_NODE_ID),o=r&&(new DOMParser).parseFromString(t,"text/html").querySelector(r[1]);mixin(model,evalObject(r?o.innerHTML:t,e)),applyPlugins(),jtmpl(target,n,model)});else jtmpl(target,n,model)}function loadTemplate(){if(src)if(src.match(consts.RE_NODE_ID)){var e=document.querySelector(src);loadModel(e.getAttribute("data-model"),e.innerHTML,document)}else jtmpl("GET",src,function(e){var n,t=src.match(consts.RE_ENDS_WITH_NODE_ID);t?(n=document.implementation.createHTMLDocument(""),n.documentElement.innerHTML=e):n=document;var r=t&&n.querySelector(t[1]);loadModel(t?r.getAttribute("data-model"):"",t?r.innerHTML:e,n)})}var consts=_dereq_("./consts");model=model||{},"function"!=typeof model&&(model=jtmpl.freak(model)),loadTemplate()}},{"./consts":4}],7:[function(e,n){function t(){var n,o,i,c,l=[].slice.call(arguments);return["GET","POST"].indexOf(l[0])>-1?e("./xhr").apply(null,l):1===l.length&&"string"==typeof l[0]?document.querySelector(l[0]).__jtmpl__:void((l[0]instanceof Node||"string"==typeof l[0])&&(l[1]instanceof Node||l[1]instanceof DocumentFragment||"string"==typeof l[1])&&void 0!==l[2]&&(n=l[0]instanceof Node?l[0]:document.querySelector(l[0]),i=l[1].match(r.RE_NODE_ID)?document.querySelector(l[1]).innerHTML:l[1],c="function"==typeof l[2]?l[2]:t.freak("object"==typeof l[2]?l[2]:"string"==typeof l[2]&&l[2].match(r.RE_NODE_ID)?e("./loader")(document.querySelector(l[2]).innerHTML):{".":l[2]}),"SCRIPT"===n.nodeName&&(o=document.createElement("div"),o.id=n.id,n.parentNode.replaceChild(o,n),n=o),n.__jtmpl__=c,n.innerHTML="",n.appendChild(e("./compiler")(i,c,l[3]))))}var r=e("./consts");document.addEventListener("DOMContentLoaded",function(){for(var n=e("./loader"),t=document.querySelectorAll("[data-jtmpl]"),r=0,o=t.length;o>r;r++)n(t[r],t[r].getAttribute("data-jtmpl"))}),t.freak=e("freak"),t.plugins={init:function(e){"function"==typeof e&&e.call(this)}},n.exports=t},{"./compiler":3,"./consts":4,"./loader":6,"./xhr":16,freak:2}],8:[function(e,n){n.exports=[e("./rules/value-var"),e("./rules/class-section"),e("./rules/section"),e("./rules/inverted-section"),e("./rules/partial"),e("./rules/unescaped-var"),e("./rules/var")]},{"./rules/class-section":9,"./rules/inverted-section":10,"./rules/partial":11,"./rules/section":12,"./rules/unescaped-var":13,"./rules/value-var":14,"./rules/var":15}],9:[function(e,n){n.exports=function(n,t,r,o){var i,c=n.match(new RegExp("#"+e("../consts").RE_SRC_IDENTIFIER)),l=c&&c[1];return"class"===r&&c?{block:l,replace:function(e){return i=e,""},change:function(){var n=o(l);e("element-class")(t)[!!n&&"add"||"remove"](i)}}:void 0}},{"../consts":4,"element-class":1}],10:[function(e,n){n.exports=function(n,t,r,o){function i(){for(var e,n,t="."===u?o:o(u);f;)d.parentNode.removeChild(d.previousSibling),f--;"function"==typeof t&&void 0!==t.len?(t.on("insert",i),t.on("delete",i),n=document.createDocumentFragment(),0===t.len&&n.appendChild(l(c,t(e))),f=n.childNodes.length,d.parentNode.insertBefore(n,d)):t||(n=l(c,o),f=n.childNodes.length,d.parentNode.insertBefore(n,d))}var c,l=e("../compiler"),a=n.match(new RegExp("^\\^"+e("../consts").RE_SRC_IDENTIFIER)),u=a&&a[1],s=document.createDocumentFragment(),d=document.createComment(""),f=0;return a?{prop:u,block:u,replace:function(e){return s.appendChild(d),c=e,d},change:i}:void 0}},{"../compiler":3,"../consts":4}],11:[function(e,n){n.exports=function(n,t,r,o){var i,c=e("../consts"),l=n.match(c.RE_PARTIAL),a=document.createComment(""),u=l&&function(){i||(i=a.parentNode),e("../loader")(i,l[1]?o(l[1]):l[2]||l[3],o)};return l?(l[1]&&o.on("change",l[1],u),setTimeout(u,0),{replace:a}):void 0}},{"../consts":4,"../loader":6}],12:[function(e,n){n.exports=function(n,t,r,o){function i(e){return function(){var n=m.parentNode,t=[].indexOf.call(n.childNodes,m),r=t-h+e*u.childNodes.length;n.replaceChild(s(u,o(f)(e)),n.childNodes[r])}}function c(e,n){var t,r,i=m.parentNode,c=[].indexOf.call(i.childNodes,m),l=c-h+e*u.childNodes.length,a=n*u.childNodes.length;for(t=0,r=document.createDocumentFragment();n>t;t++)r.appendChild(s(u,o(f)(e+t)));i.insertBefore(r,i.childNodes[l]),h+=a}function l(e,n){var t=m.parentNode,r=[].indexOf.call(t.childNodes,m),o=r-h+e*u.childNodes.length,i=n*u.childNodes.length;for(h-=i;i--;)t.removeChild(t.childNodes[o])}function a(){for(var e,n,t,r="."===f?o:o(f);h;)m.parentNode.removeChild(m.previousSibling),h--;if("function"==typeof r&&void 0!==r.len){for(r.on("insert",c),r.on("delete",l),t=document.createDocumentFragment(),e=0,n=r.len;n>e;e++)r.on("change",e,i(e)),t.appendChild(s(u,r(e)));h=t.childNodes.length,m.parentNode.insertBefore(t,m)}else"function"==typeof r&&void 0===r.len?(t=s(u,r),h=t.childNodes.length,m.parentNode.insertBefore(t,m)):r&&(t=s(u,o),h=t.childNodes.length,m.parentNode.insertBefore(t,m))}var u,s=e("../compiler"),d=n.match(new RegExp("^#"+e("../consts").RE_SRC_IDENTIFIER)),f=d&&d[1],p=document.createDocumentFragment(),m=document.createComment(""),h=0;return d?{prop:f,block:f,replace:function(e){return p.appendChild(m),u=e,m},change:a}:void 0}},{"../compiler":3,"../consts":4}],13:[function(e,n){n.exports=function(n,t,r,o){var i=n.match(new RegExp("^&"+e("../consts").RE_SRC_IDENTIFIER)),c=i&&i[1],l=document.createComment(""),a=0;return i&&!r?{prop:c,replace:l,change:function(){for(var e,n=document.createDocumentFragment(),t=document.createElement("body");a;)l.parentNode.removeChild(l.previousSibling),a--;for(t.innerHTML=o(c)||"",a=t.childNodes.length,e=0;a>e;e++)n.appendChild(t.childNodes[0]);l.parentNode.insertBefore(n,l)}}:void 0}},{"../consts":4}],14:[function(e,n){n.exports=function(n,t,r,o){function i(){var e=o(l);t[r]!==e&&(t[r]=e||"")}var c=n.match(e("../consts").RE_IDENTIFIER),l=c&&c[0];if(c&&["value","checked","selected"].indexOf(r)>-1){"OPTION"===t.nodeName&&setTimeout(function(){t&&t.parentNode&&t.parentNode.addEventListener("change",function(){o(l)!==t.selected&&o(l,t.selected)})},0),"radio"===t.type&&t.name&&t.addEventListener("change",function(){if(t[r])for(var e=0,n=document.querySelectorAll("input[type=radio][name="+t.name+"]"),i=n.length;i>e;e++)n[e]!==t&&n[e].dispatchEvent(new Event("change"));o(l,t[r])});var a=["text","password"].indexOf(t.type)>-1?"input":"change";return t.addEventListener(a,function(){o(l,t[r])}),{prop:l,replace:"",change:i}}}},{"../consts":4}],15:[function(e,n){n.exports=function(n,t,r,o){function i(){var e=o(n);return"function"==typeof e?JSON.stringify(e.values):e}var c,l;return n.match(e("../consts").RE_IDENTIFIER)?(r?l=function(){var e=i();return e?t.setAttribute(r,e):t.removeAttribute(r)}:(c=document.createTextNode(""),l=function(){c.data=i()||""}),{prop:n,replace:c,change:l}):void 0}},{"../consts":4}],16:[function(e,n){n.exports=function(){var e,n,t,r,o,i=[].slice.call(arguments),c=new XMLHttpRequest,l=i.reduce(function(e,n){return"function"==typeof n?n:e},null),a=i[i.length-1];for("object"!=typeof a&&(a={}),e=0,r=Object.getOwnPropertyNames(a),n=r.length;n>e;e++)t=r[e],c[t]=a[t];o="string"==typeof i[2]?i[2]:"object"==typeof i[2]?Object.keys(i[2]).map(function(e){return e+"="+encodeURIComponent(i[2][e])}).join("&"):"",c.onload=function(e){var n;if(l){try{n=JSON.parse(this.responseText)}catch(e){n=this.responseText}l.call(this,n,e)}},c.open(i[0],i[1],void 0!==a.async?a.async:!0,a.user,a.password),c.send(o)}},{}],17:[function(e,n){var t=e("jtmpl-core/src/main");t.plugins.on=e("./plugins/on"),n.exports=t},{"./plugins/on":18,"jtmpl-core/src/main":7}],18:[function(e,n){n.exports=function(e,n){function t(t){n.addEventListener(t,function(n){for(var r in e[t])n.target.matches(r)&&e[t][r].call(n.target.__jtmpl__,n)})}for(var r in e)t(r)}},{}]},{},[17])(17)});