/*! jtmpl 17-06-2014 */
!function(root){"use strict";function j(){var a=[].slice.call(arguments);return["GET","POST"].indexOf(a[0])>-1?j.xhr(a):"string"==typeof a[0]&&"object"==typeof a[1]&&["object","undefined"].indexOf(typeof a[2])>-1?j.compile.apply(null,a):void 0}function pathtoRegexp(a,b,c){c=c||{};var d=c.strict,e=c.end!==!1,f=c.sensitive?"":"i";return b=b||[],a instanceof RegExp?a:Array.isArray(a)?(a=a.map(function(a){return pathtoRegexp(a,b,c).source}),new RegExp("(?:"+a.join("|")+")",f)):(a=("^"+a+(d?"":"/?")).replace(/([\/\.\|])/g,"\\$1").replace(/(\\\/)?(\\\.)?:(\w+)(\(.*?\))?(\*)?(\?)?/g,function(a,c,d,e,f,g,h){return c=c||"",d=d||"",f=f||"([^\\/"+d+"]+?)",h=h||"",b.push({name:e,optional:!!h}),""+(h?"":c)+"(?:"+d+(h?c:"")+f+(g?"((?:[\\/"+d+"].+?)?)":"")+")"+h}).replace(/\*/g,"(.*)"),a+=e?"$":"/"===a[a.length-1]?"":"(?=\\/|$)",new RegExp(a,f))}function escapeRE(a){return(a+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function tokenizer(a,b){return RegExp(escapeRE(a.delimiters[0])+"("+RE_ANYTHING+")"+escapeRE(a.delimiters[1]),b)}function matchRules(a,b,c,d,e){var f,g,h=j.rules,i=j.rules.length;for(a=a.slice(e.delimiters[0].length,-e.delimiters[1].length),f=0;i>f;f++)if(g=h[f](a,b,c,d,e))return g.index=f,g}function wrapTagsInHTMLComments(a,b){return a.replace(tokenizer(b,"g"),function(b,c,d){var e=a.slice(0,d),f=!!e.match(RegExp("<"+RE_SRC_IDENTIFIER+"[^>]*?$")),g=!!e.match(/<!--\s*$/);return f||g?b:"<!--"+b+"-->"})}function matchEndBlock(a,b,c){var d=b.match(RegExp(escapeRE(c.delimiters[0])+"\\/"+RE_SRC_IDENTIFIER+"?"+escapeRE(c.delimiters[1])));return d?""===a||void 0===d[1]||d[1]===a:!1}var RE_IDENTIFIER=/^[\w\.\-]+$/,RE_SRC_IDENTIFIER="([\\w\\.\\-]+)",RE_PIPE=/^[\w\.\-]+(?:\|[\w\.\-]+)?$/,RE_NODE_ID=/^#[\w\.\-]+$/,RE_ANYTHING="[\\s\\S]*?",RE_SPACE="\\s*",defaultOptions={delimiters:["{{","}}"]};j.identity=function(a){return a},j.isDefined=function(a){return null!==a&&void 0!==a},j.extend=function(a,b){var c,d={};for(c in a)a.hasOwnProperty(c)&&(d[c]=a[c]);for(c in b)b.hasOwnProperty(c)&&(d[c]=a[b]);return d},j.hasClass=function(a,b){return new RegExp("(\\s|^)"+b+"(\\s|$)").test(a.className)},j.addClass=function(a,b){j.hasClass(a,b)||(a.className+=(a.className&&" "||"")+b)},j.removeClass=function(a,b){j.hasClass(a,b)&&(a.className=a.className.replace(new RegExp("(\\s|^)"+b+"(\\s|$)"),"").replace(/^\s+|\s+$/g,""))},j.compile=function(a,b,c){var d,e,f,g,h,i,k,l,m,n,o,p,q,r,s,t,u,v=document.createDocumentFragment();for(c=c||defaultOptions,a instanceof Node?o=a:(a=wrapTagsInHTMLComments(a,c),o=document.createElement("body"),o.innerHTML=a),"object"!=typeof b&&(b={".":b}),j.bind(b),d=0,e=o.childNodes,f=e.length;f>d;d++)switch(p=e[d],q=p.cloneNode(!1),v.appendChild(q),q.nodeType){case 1:for(g=0,h=q.attributes.length;h>g;g++)for(i=q.attributes[g],k=i.value,r=tokenizer(c,"g");s=r.exec(k);)if(t=matchRules(s[0],q,i.name,b,c)){if(t.block){for(u=s[0],m=s.index,n=s.index+s[0].length;s&&!matchEndBlock(t.block,s[0],c);s=r.exec(k));if(!s)throw"Unclosed"+u;i.value=i.value.slice(0,m)+t.replace(i.value.slice(n,s.index))+i.value.slice(s.index+s[0].length)}t.react&&"object"==typeof b&&b.__&&(j.watch(b,t.prop,t.react,t.arrayReact||null,t.prop+d+"."+g),l=b.__(t.prop,t.react),void 0!==l&&t.react(l))}q.appendChild(j.compile(p,b,c));break;case 8:if(matchEndBlock("",q.data,c))throw"jtmpl: Unexpected "+q.data;if((s=q.data.match(tokenizer(c)))&&(t=matchRules(q.data,s[1],null,b,c))){if(t.replace instanceof Node&&q.parentNode.replaceChild(t.replace,q),t.block){for(u=document.createDocumentFragment(),d++;f>d&&!matchEndBlock(t.block,e[d].data||"",c);d++)u.appendChild(e[d].cloneNode(!0));if(d===f)throw"jtmpl: Unclosed "+q.data;q.parentNode.replaceChild(t.replace(u,q.parentNode),q)}t.react&&"object"==typeof b&&b.__&&(j.watch(b,t.prop,t.react,t.arrayReact||null,t.prop+d),l=b.__(t.prop,t.react),void 0!==l&&t.react(l))}}return v},j.bind=function(a,b,c){var d,e,f,g;if("object"==typeof a&&!a.__){var h=function(b,c,d,e,f){var g,i,k,l,m=function(b){var c=a.__.values[b];return e("function"==typeof c?c.call(m):c)},n=function(c){return-1===a.__.dependents[c].indexOf(b)&&a.__.dependents[c].push(b),m(c)};if(e=e||j.identity,h.dependents[b]||(h.dependents[b]=[]),!(void 0!==c&&"function"!=typeof c||d))return".."===b?a.__.parent.__:"/"===b?a.__.root.__:(l=a.__.values[b],k="function"==typeof l?l.call(n):l,Array.isArray(k)?"function"==typeof f?k.map(f).filter(j.isDefined):k:e(k));for(d||("function"==typeof h.values[b]?h.values[b].call(a.__,c):h.values[b]=c),g=0,i=h.dependents[b].length;i>g;g++)a.__(h.dependents[b][g],c,!0);if(h.watchers[b])for(g=0,i=h.watchers[b].length;i>g;g++)h.watchers[b][g](a.__(b))};h.dependents={},h.watchers={},h.arrayWatchers=[],h.root=b||a,h.parent=c||null,h.values=Array.isArray(a)?[]:{},h.bound={};var i=function(b){"length"===b&&Array.isArray(a)||(h.values[b]=a[b],Object.defineProperty(a,b,{get:function(){return a.__(b)},set:function(c){a.__(b,c)}}))};if(Object.getOwnPropertyNames(a).map(i),Object.defineProperty(a,"__",{value:h}),Array.isArray(a)){g=a.__.values,d=function(b,c,d){for(var e=0,f=a.__.arrayWatchers.length;f>e;e++)a.__.arrayWatchers[e](b,c,d)},f={pop:function(){var a=[].pop.apply(this);return d("del",this.length,1),a},push:function(){var a=[].push.apply(this,arguments);return d("ins",this.length-1,1),a},reverse:function(){var a=[].reverse.apply(this);return d("upd",0,this.length),a},shift:function(){var a=[].shift.apply(this);return d("del",0,1),a},unshift:function(){var a=[].unshift.apply(this,arguments);return d("ins",0,arguments.length),a},sort:function(){var a=[].sort.apply(this,arguments);return d("upd",0,this.length),a},splice:function(){var a=[].splice.apply(this,arguments);return arguments[1]&&d("del",arguments[0],arguments[1]),arguments.length>2&&d("ins",arguments[0],arguments.length-2),a}};for(e in f)h[e]=f[e],a[e]=f[e]}}},j.watch=function(a,b,c,d,e){var f,g;a&&b&&c&&"object"==typeof a&&(e&&a.__&&a.__.bound[e]||(j.bind(a),e&&(a.__.bound[e]=!0),f=a.__.watchers,f[b]||(f[b]=[]),-1===f[b].indexOf(c)&&f[b].push(c),d&&Array.isArray(a[b])&&(j.bind(a[b]),g=a[b].__.arrayWatchers,-1===g.indexOf(d)&&g.push(d))))},j.rules=[function(a,b,c,d,e){var f=a.match(RE_IDENTIFIER);return"class"===c&&f?(j.removeClass(b,e.delimiters[0]+a+e.delimiters[1]),{prop:a,react:function(c){(!!c&&j.addClass||j.removeClass)(b,a)}}):void 0},function(a,b,c){var d,e=a.match(new RegExp("#"+RE_SRC_IDENTIFIER));return"class"===c&&e?{prop:e[1],replace:function(a){return d=a,""},react:function(a){(!!a&&j.addClass||j.removeClass)(b,d)},block:e[1]}:void 0},function(a,b,c,d){var e,f,g=a.match(new RegExp("#"+RE_SRC_IDENTIFIER)),h=document.createDocumentFragment(),i=document.createComment(""),k=0;return g?{prop:g[1],replace:function(a,b){return h.appendChild(i),e=a,f=b.childNodes.length,i},react:function(a){for(var b,c,f;k;)i.parentNode.removeChild(i.previousSibling),k--;if(Array.isArray(a)){for(f=document.createDocumentFragment(),b=0,c=a.length;c>b;b++)f.appendChild(j.compile(e,a[b]));k=f.childNodes.length,i.parentNode.insertBefore(f,i)}else"object"==typeof a?(f=j.compile(e,a),k=f.childNodes.length,i.parentNode.insertBefore(f,i)):a&&(f=j.compile(e,d),k=f.childNodes.length,i.parentNode.insertBefore(f,i))},block:g[1],arrayReact:function(){console.log(arguments)}}:void 0},function(a,b,c){var d;return a.match(RE_IDENTIFIER)?c?{prop:a,react:function(a){return a?b.setAttribute(c,a):b.removeAttribute(c)}}:(d=document.createTextNode(""),{prop:a,replace:d,react:function(a){d.data=a||""}}):void 0}],j.xhr=function(a){var b,c,d,e,f,g=new XMLHttpRequest,h=a.reduce(function(a,b){return"function"==typeof b?b:a},null),i=a[a.length-1];for("object"!=typeof i&&(i={}),b=0,e=Object.getOwnPropertyNames(i),c=e.length;c>b;b++)d=e[b],g[d]=i[d];f="string"==typeof a[2]?a[2]:"object"==typeof a[2]?Object.keys(a[2]).map(function(b){return b+"="+encodeURIComponent(a[2][b])}).join("&"):"",g.onload=function(a){var b;if(h){try{b=JSON.parse(this.responseText)}catch(c){b=this.responseText}h.call(this,b,a)}},g.open(a[0],a[1],void 0!==i.async?i.async:!0,i.user,i.password),g.send(f)},j.loadModel=function(body){var result;return body.match(/^\s*{.*}\s*$/)?eval("result="+body):new Function("module","exports",body+";return module.exports;")({},{})},"undefined"==typeof module?root.jtmpl=j:exports=module.exports=j}(this);