/*! jtmpl 15-06-2014 */
!function(root){"use strict";function j(){var a=[].slice.call(arguments);return["GET","POST"].indexOf(a[0])>-1?j.xhr(a):"string"==typeof a[0]&&"object"==typeof a[1]&&["object","undefined"].indexOf(typeof a[2])>-1?j.compile.apply(null,a):void 0}function pathtoRegexp(a,b,c){c=c||{};var d=c.strict,e=c.end!==!1,f=c.sensitive?"":"i";return b=b||[],a instanceof RegExp?a:Array.isArray(a)?(a=a.map(function(a){return pathtoRegexp(a,b,c).source}),new RegExp("(?:"+a.join("|")+")",f)):(a=("^"+a+(d?"":"/?")).replace(/([\/\.\|])/g,"\\$1").replace(/(\\\/)?(\\\.)?:(\w+)(\(.*?\))?(\*)?(\?)?/g,function(a,c,d,e,f,g,h){return c=c||"",d=d||"",f=f||"([^\\/"+d+"]+?)",h=h||"",b.push({name:e,optional:!!h}),""+(h?"":c)+"(?:"+d+(h?c:"")+f+(g?"((?:[\\/"+d+"].+?)?)":"")+")"+h}).replace(/\*/g,"(.*)"),a+=e?"$":"/"===a[a.length-1]?"":"(?=\\/|$)",new RegExp(a,f))}function ObservableArray(a,b){function c(a,b){return void 0===b?d[a]:d[a]=b}var d,e,f={pop:function(){d.pop();b([{type:"delete",name:d.length,object:d}])},push:function(){}};for(e in f)c[e]=f[e];return d=a,c}function escapeRE(a){return(a+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function tokenizer(a,b){return RegExp(escapeRE(a.delimiters[0])+"("+RE_ANYTHING+")"+escapeRE(a.delimiters[1]),b)}function matchRules(a,b,c,d,e){var f,g,h=j.rules,i=j.rules.length;for(a=a.slice(e.delimiters[0].length,-e.delimiters[1].length),f=0;i>f;f++)if(g=h[f](a,b,c,d,e))return g.index=f,g}function wrapTagsInHTMLComments(a,b){return a.replace(tokenizer(b,"g"),function(b,c,d){var e=a.slice(0,d),f=!!e.match(RegExp("<"+RE_SRC_IDENTIFIER+"[^>]*?$")),g=!!e.match(/<!--\s*$/);return f||g?b:"<!--"+b+"-->"})}function matchEndBlock(a,b,c){var d=b.match(RegExp(escapeRE(c.delimiters[0])+"\\/"+RE_SRC_IDENTIFIER+"?"+escapeRE(c.delimiters[1])));return d?""===a||void 0===d[1]||d[1]===a:!1}var RE_IDENTIFIER=/^[\w\.\-]+$/,RE_SRC_IDENTIFIER="([\\w\\.\\-]+)",RE_PIPE=/^[\w\.\-]+(?:\|[\w\.\-]+)?$/,RE_NODE_ID=/^#[\w\.\-]+$/,RE_ANYTHING="[\\s\\S]*?",RE_SPACE="\\s*",bookkeepingProto={dependents:{},watchers:{},childContexts:[],initialized:!1},defaultOptions={delimiters:["{{","}}"]};j.identity=function(a){return a},j.isDefined=function(a){return null!==a&&void 0!==a},j.extend=function(a,b){var c,d={};for(c in a)a.hasOwnProperty(c)&&(d[c]=a[c]);for(c in b)b.hasOwnProperty(c)&&(d[c]=a[b]);return d},j.hasClass=function(a,b){return new RegExp("(\\s|^)"+b+"(\\s|$)").test(a.className)},j.addClass=function(a,b){j.hasClass(a,b)||(a.className+=(a.className&&" "||"")+b)},j.removeClass=function(a,b){j.hasClass(a,b)&&(a.className=a.className.replace(new RegExp("(\\s|^)"+b+"(\\s|$)"),"").replace(/^\s+|\s+$/g,""))},j.ObservableArray=ObservableArray,j.bind=function(a,b,c){if("object"==typeof a&&!a.__){var d=function(b,c,e,f,g){var h,i,k,l,m=function(b){var c=a.__.values[b];return f("function"==typeof c?c.call(m):c)},n=function(c){return-1===a.__.dependents[c].indexOf(b)&&a.__.dependents[c].push(b),m(c)};if(f=f||j.identity,d.dependents[b]||(d.dependents[b]=[]),!(void 0!==c&&"function"!=typeof c||e))return"."===b?f(model):".."===b?a.__.parent.__:"/"===b?a.__.root.__:(l=a.__.values[b],k="function"==typeof l?l.call(n):l,Array.isArray(k)?"function"==typeof g?k.map(g).filter(j.isDefined):k:f(k));for(e||("function"==typeof d.values[b]?d.values[b].call(a.__,c):d.values[b]=c),h=0,i=d.dependents[b].length;i>h;h++)a.__(d.dependents[b][h],c,!0);if(d.watchers[b])for(h=0,i=d.watchers[b].length;i>h;h++)d.watchers[b][h](a.__(b))};d.dependents={},d.watchers={},d.root=b||a,d.parent=c||null,d.values={},d.bound={},Object.getOwnPropertyNames(a).map(function(b){d.values[b]=a[b],Object.defineProperty(a,b,{get:function(){return a.__(b)},set:function(c){a.__(b,c)}})}),Object.defineProperty(a,"__",{value:d})}},j.compile=function(a,b,c,d){var e,f,g,h,i,k,l,m,n,o,p,q,r,s,t,u=document.createDocumentFragment();for(c=c||defaultOptions,a instanceof Node?n=a:(a=wrapTagsInHTMLComments(a,c),n=document.createElement("body"),n.innerHTML=a),j.bind(b),e=0,f=n.childNodes,g=f.length;g>e;e++)switch(o=f[e],p=o.cloneNode(!1),u.appendChild(p),p.nodeType){case 1:for(h=0,i=p.attributes.length;i>h;h++)for(k=p.attributes[h],l=k.value,q=tokenizer(c,"g");r=q.exec(l);)if(s=matchRules(r[0],p,k.name,b,c)){if(s.block){for(t="",d=r[0],beginPos=r.index,bodyBeginPos=r.index+r[0].length;r&&!matchEndBlock(s.block,r[1],c);r=q.exec(l));if(!r)throw"Unclosed"+d;k.value=k.value.slice(0,beginPos)+s.replace(k.value.slice(bodyBeginPos,r.index-bodyBeginPos))+k.value.slice(r.index+r[0].length)}s.react&&(j.watch(b,s.prop,s.react,s.prop+e+"."+h),m=b.__(s.prop,s.react),void 0!==m&&s.react(m))}p.appendChild(j.compile(o,b,c));break;case 8:if(matchEndBlock("",p.data,c))throw"jtmpl: Unexpected "+p.data;if((r=p.data.match(tokenizer(c)))&&(s=matchRules(p.data,r[1],null,b,c))){if(s.replace instanceof Node&&p.parentNode.replaceChild(s.replace,p),s.block){for(t=document.createDocumentFragment(),e++;g>e&&!matchEndBlock(s.block,f[e].data||"",c);e++)t.appendChild(f[e].cloneNode(!0));if(e===g)throw"jtmpl: Unclosed "+p.data;p.parentNode.replaceChild(s.replace(t,p.parentNode),p)}s.react&&(j.watch(b,s.prop,s.react,s.prop+e),m=b.__(s.prop,s.react),void 0!==m&&s.react(m))}}return u},j.watch=function(a,b,c,d){var e;a&&b&&c&&(d&&a.__&&a.__.bound[d]||(j.bind(a),d&&(a.__.bound[d]=!0),e=a.__.watchers,e[b]||(e[b]=[]),-1===e[b].indexOf(c)&&e[b].push(c)))},j.rules=[function(a,b,c,d,e){var f=a.match(RE_IDENTIFIER);return"class"===c&&f?(j.removeClass(b,e.delimiters[0]+a+e.delimiters[1]),{prop:a,react:function(c){(!!c&&j.addClass||j.removeClass)(b,a)}}):void 0},function(a,b,c){var d=a.match(new RegExp("#"+RE_SRC_IDENTIFIER));return"class"===c&&d?{prop:d[1],react:function(c){(!!c&&j.addClass||j.removeClass)(b,a)},block:d[1]}:void 0},function(a,b,c,d){var e,f,g=a.match(new RegExp("#"+RE_SRC_IDENTIFIER)),h=document.createDocumentFragment(),i=document.createComment(""),k=0;return g?{prop:g[1],replace:function(a,b){return h.appendChild(i),e=a,f=b.childNodes.length,i},react:function(a){for(var b;k;)i.parentNode.removeChild(i.previousSibling),k--;Array.isArray(a)||("object"==typeof a?(b=j.compile(e,a),k=b.childNodes.length,i.parentNode.insertBefore(b,i)):a&&(b=j.compile(e,d),k=b.childNodes.length,i.parentNode.insertBefore(b,i)))},block:g[1]}:void 0},function(a,b,c){var d;return a.match(RE_IDENTIFIER)?c?{prop:a,react:function(a){return a?b.setAttribute(c,a):b.removeAttribute(c)}}:(d=document.createTextNode(""),{prop:a,replace:d,react:function(a){d.data=a||""}}):void 0}],j.xhr=function(a){var b,c,d,e,f,g=new XMLHttpRequest,h=a.reduce(function(a,b){return"function"==typeof b?b:a},null),i=a[a.length-1];for("object"!=typeof i&&(i={}),b=0,e=Object.getOwnPropertyNames(i),c=e.length;c>b;b++)d=e[b],g[d]=i[d];f="string"==typeof a[2]?a[2]:"object"==typeof a[2]?Object.keys(a[2]).map(function(b){return b+"="+encodeURIComponent(a[2][b])}).join("&"):"",g.onload=function(a){var b;if(h){try{b=JSON.parse(this.responseText)}catch(c){b=this.responseText}h.call(this,b,a)}},g.open(a[0],a[1],void 0!==i.async?i.async:!0,i.user,i.password),g.send(f)},j.loadModel=function(body){var result;return body.match(/^\s*{.*}\s*$/)?eval("result="+body):new Function("module","exports",body+";return module.exports;")({},{})},"undefined"==typeof module?root.jtmpl=j:exports=module.exports=j}(this);