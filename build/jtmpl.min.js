!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.jtmpl=e()}}(function(){var define,module,exports;return function e(t,n,o){function r(l,c){if(!n[l]){if(!t[l]){var s="function"==typeof require&&require;if(!c&&s)return s(l,!0);if(i)return i(l,!0);throw new Error("Cannot find module '"+l+"'")}var a=n[l]={exports:{}};t[l][0].call(a.exports,function(e){var n=t[l][1][e];return r(n?n:e)},a,a.exports,e,t,n,o)}return n[l].exports}for(var i="function"==typeof require&&require,l=0;l<o.length;l++)r(o[l]);return r}({1:[function(e,t){t.exports=function t(n,o,r){function i(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function l(e,t){return RegExp(i(e.delimiters[0])+"("+w.RE_ANYTHING+")"+i(e.delimiters[1]),t)}function c(t,n,o,r,i){var l,c,s=e("./rules"),a=s.length;for(t=t.slice(i.delimiters[0].length,-i.delimiters[1].length),l=0;a>l;l++)if(c=s[l](t,n,o,r,i))return c.index=l,c}function s(e,t){return e.replace(l(t,"g"),function(t,n,o){var r=e.slice(0,o),i=!!r.match(RegExp("<"+w.RE_SRC_IDENTIFIER+"[^>]*?$")),l=!!r.match(/<!--\s*$/);return i||l?t:"<!--"+t+"-->"})}function a(e,t,n){var o=t.match(RegExp(i(n.delimiters[0])+"\\/"+w.RE_SRC_IDENTIFIER+"?"+i(n.delimiters[1])));return o?""===e||void 0===o[1]||o[1]===e:!1}var u,d,f,p,m,h,g,v,y,N,x,E,b,R,I,_,w=e("./consts"),T=document.createDocumentFragment(),C=e("freak");for(r=r||e("./default-options"),o="function"==typeof o?o:C("object"==typeof o?o:{".":o}),n instanceof Node?N=n:(n=s(n,r),N=document.createElement("body"),N.innerHTML=n),u=0,d=N.childNodes,f=d.length;f>u;u++)switch(x=d[u],E=x.cloneNode(!1),T.appendChild(E),E.nodeType){case 1:for(p=0,m=E.attributes.length;m>p;p++)for(h=E.attributes[p],g=h.value,b=l(r,"g");R=b.exec(g);)if(I=c(R[0],E,h.name,o,r),I&&I.block){for(_=R[0],v=R.index,y=R.index+R[0].length;R&&!a(I.block,R[0],r);R=b.exec(g));if(!R)throw"Unclosed"+_;h.value=h.value.slice(0,v)+I.replace(h.value.slice(y,R.index))+h.value.slice(R.index+R[0].length)}E.appendChild(t(x,o,r));break;case 8:if(a("",E.data,r))throw"jtmpl: Unexpected "+E.data;if((R=E.data.match(l(r)))&&(I=c(E.data,R[1],null,o,r),I&&(I.replace instanceof Node&&E.parentNode.replaceChild(I.replace,E),I.block))){for(_=document.createDocumentFragment(),u++;f>u&&!a(I.block,d[u].data||"",r);u++)_.appendChild(d[u].cloneNode(!0));if(u===f)throw"jtmpl: Unclosed "+E.data;E.parentNode.replaceChild(I.replace(_,E.parentNode),E)}}return T}},{"./consts":2,"./default-options":3,"./rules":6,freak:14}],2:[function(e,t){t.exports={RE_IDENTIFIER:/^[\w\.\-]+$/,RE_SRC_IDENTIFIER:"([\\w\\.\\-]+)",RE_PIPE:/^[\w\.\-]+(?:\|[\w\.\-]+)?$/,RE_NODE_ID:/^#[\w\.\-]+$/,RE_ANYTHING:"[\\s\\S]*?",RE_SPACE:"\\s*"}},{}],3:[function(e,t){t.exports={delimiters:["{{","}}"]}},{}],4:[function(_dereq_,module,exports){module.exports=function(body){var result,module={exports:{}};return body.match(/^\s*{[\S\s]*}\s*$/)?eval("result="+body):new Function("module","exports",body+";return module.exports;")(module,module.exports)}},{}],5:[function(e,t){function n(){var t,n,o,r,i=[].slice.call(arguments),l=e("./consts");return["GET","POST"].indexOf(i[0])>-1?e("./xhr").apply(null,i):"string"==typeof i[0]&&["object","function"].indexOf(typeof i[1])>-1&&["object","undefined"].indexOf(typeof i[2])>-1?e("./compiler").apply(null,i):void((i[0]instanceof Node||"string"==typeof i[0])&&(i[1]instanceof Node||i[1]instanceof DocumentFragment||"string"==typeof i[1])&&("object"==typeof i[2]||"string"==typeof i[2])&&void 0!==i[2]&&(t=i[0]instanceof Node?i[0]:document.querySelector(i[0]),o=i[1].match(l.RE_NODE_ID)?document.querySelector(i[1]).innerHTML:i[1],r="object"==typeof i[2]?i[2]:i[2].match(l.RE_NODE_ID)?e("./eval-object")(document.querySelector(i[2]).innerHTML):void 0,"SCRIPT"===t.nodeName&&(n=document.createElement("div"),n.id=t.id,t.parentNode.replaceChild(n,t),t=n),t.innerHTML="",t.appendChild(e("./compiler")(o,r,i[3]))))}document.addEventListener("DOMContentLoaded",function(){for(var t,o=document.querySelectorAll("[data-template]"),r=0,i=o.length;i>r;r++)t=o[r],n(t,document.querySelector(t.getAttribute("data-template")).innerHTML,e("./eval-object")(document.querySelector(t.getAttribute("data-model")).innerHTML))}),n.freak=e("freak"),t.exports=n},{"./compiler":1,"./consts":2,"./eval-object":4,"./xhr":12,freak:14}],6:[function(e,t){t.exports=[e("./rules/onevent"),e("./rules/class-block"),e("./rules/class-var"),e("./rules/block"),e("./rules/var")]},{"./rules/block":7,"./rules/class-block":8,"./rules/class-var":9,"./rules/onevent":10,"./rules/var":11}],7:[function(e,t){t.exports=function(t,n,o,r){function i(e){return function(){var t=m.parentNode,n=[].indexOf.call(t.childNodes,m),o=n-h+e*a.childNodes.length;t.replaceChild(u(a,r(f)(e)),t.childNodes[o])}}function l(e,t){var n,o,i=m.parentNode,l=[].indexOf.call(i.childNodes,m),c=l-h+e*a.childNodes.length,s=t*a.childNodes.length;for(n=0,o=document.createDocumentFragment();t>n;n++)o.appendChild(u(a,r(f)(e+n)));i.insertBefore(o,i.childNodes[c]),h+=s}function c(e,t){var n=m.parentNode,o=[].indexOf.call(n.childNodes,m),r=o-h+e*a.childNodes.length,i=t*a.childNodes.length;for(h-=i;i--;)n.removeChild(n.childNodes[r])}function s(){for(var e,t,n,o=r(f);h;)m.parentNode.removeChild(m.previousSibling),h--;if("function"==typeof o&&o.len){for(o.on("insert",l),o.on("delete",c),n=document.createDocumentFragment(),e=0,t=o.len;t>e;e++)o.on("change",e,i(e)),n.appendChild(u(a,o(e)));h=n.childNodes.length,m.parentNode.insertBefore(n,m)}else"function"!=typeof o||o.len?o&&(n=u(a,r),h=n.childNodes.length,m.parentNode.insertBefore(n,m)):(n=u(a,o),h=n.childNodes.length,m.parentNode.insertBefore(n,m))}var a,u=e("../compiler"),d=t.match(new RegExp("#"+e("../consts").RE_SRC_IDENTIFIER)),f=d&&d[1],p=document.createDocumentFragment(),m=document.createComment(""),h=0;return d?(r.on("change",f,s),s(),{block:f,replace:function(e){return p.appendChild(m),a=e,m}}):void 0}},{"../compiler":1,"../consts":2}],8:[function(e,t){t.exports=function(t,n,o,r){function i(){var t=r(s);e("element-class")(n)[!!t&&"add"||"remove"](l)}var l,c=t.match(new RegExp("#"+e("../consts").RE_SRC_IDENTIFIER)),s=c&&c[1];return"class"===o&&c?(r.on("change",s,i),i(),{block:s,replace:function(e){return l=e,""}}):void 0}},{"../consts":2,"element-class":13}],9:[function(e,t){t.exports=function(t,n,o,r,i){function l(){s[!!r(t)&&"add"||"remove"](klass)}var c=t.match(e("../consts").RE_IDENTIFIER),s=e("element-class")(n);return"class"===o&&c?(s.remove(i.delimiters[0]+t+i.delimiters[1]),r.on("change",prop,l),l(),{}):void 0}},{"../consts":2,"element-class":13}],10:[function(e,t){t.exports=function(t,n,o,r){var i=e("../consts"),l=t.match(i.RE_IDENTIFIER),c=o&&o.match(new RegExp("on"+i.RE_SRC_IDENTIFIER));return l&&c?(n.setAttribute(o,null),n.addEventListener(c[1],r.values[t]),{}):void 0}},{"../consts":2}],11:[function(e,t){t.exports=function(t,n,o,r){var i;return t.match(e("../consts").RE_IDENTIFIER)?(o?r.on("change",t,function(){var e=r(t);return e?n.setAttribute(o,e):n.removeAttribute(o)}):(i=document.createTextNode(""),r.on("change",t,function(){i.data=r(t)||""})),r(t,r(t)),{replace:i||""}):void 0}},{"../consts":2}],12:[function(e,t){t.exports=function(){var e,t,n,o,r,i=[].slice.call(arguments),l=new XMLHttpRequest,c=i.reduce(function(e,t){return"function"==typeof t?t:e},null),s=i[i.length-1];for("object"!=typeof s&&(s={}),e=0,o=Object.getOwnPropertyNames(s),t=o.length;t>e;e++)n=o[e],l[n]=s[n];r="string"==typeof i[2]?i[2]:"object"==typeof i[2]?Object.keys(i[2]).map(function(e){return e+"="+encodeURIComponent(i[2][e])}).join("&"):"",l.onload=function(e){var t;if(c){try{t=JSON.parse(this.responseText)}catch(e){t=this.responseText}c.call(this,t,e)}},l.open(i[0],i[1],void 0!==s.async?s.async:!0,s.user,s.password),l.send(r)}},{}],13:[function(e,t){function n(e){if(!(this instanceof n))return new n(e);e||(e={}),e.nodeType&&(e={el:e}),this.opts=e,this.el=e.el||document.body,"object"!=typeof this.el&&(this.el=document.querySelector(this.el))}t.exports=function(e){return new n(e)},n.prototype.add=function(e){var t=this.el;if(t){if(""===t.className)return t.className=e;var n=t.className.split(" ");return n.indexOf(e)>-1?n:(n.push(e),t.className=n.join(" "),n)}},n.prototype.remove=function(e){var t=this.el;if(t&&""!==t.className){var n=t.className.split(" "),o=n.indexOf(e);return o>-1&&n.splice(o,1),t.className=n.join(" "),n}},n.prototype.has=function(e){var t=this.el;if(t){var n=t.className.split(" ");return n.indexOf(e)>-1}}},{}],14:[function(e,t){"use strict";function n(e,t,o){function r(e,t){if(!e)throw t||"assertion failed"}function i(e,t){for(var n=0,o=Object.getOwnPropertyNames(t),r=o.length;r>n;n++)e[o[n]]=t[o[n]]}function l(){var e=arguments[0],t="string"==typeof arguments[1]?arguments[1]:null,n="function"==typeof arguments[1]?arguments[1]:"function"==typeof arguments[2]?arguments[2]:null;r(["change","insert","delete"].indexOf(e)>-1),r("change"===e&&t||("insert"===e||"delete"===e)&&!t),u[e][t]||(u[e][t]=[]),-1===u[e][t].indexOf(n)&&u[e][t].push(n)}function c(){var e,t=arguments[0],n="string"==typeof arguments[1]?arguments[1]:null,o="function"==typeof arguments[1]?arguments[1]:"function"==typeof arguments[2]?arguments[2]:null;u[t][n]&&(o?(e=u[t][n].indexOf(o),e>-1&&u[t][n].splice(e,1)):u[t][n]=[])}function s(e,t,n){(u[e]["change"===e?t:null]||[]).map(function(e){e.call(m,t,n)})}function a(o,r,i){function l(e,t,n){return d[e]||(d[e]=[]),-1===d[e].indexOf(o)&&d[e].push(o),a(e,t,n)}var c,u,p,h,g;if(!(void 0!==r&&"function"!=typeof r||i))return g=e[o],h="function"==typeof g?g.call(l,r):g,"object"==typeof h?"function"==typeof f[o]?f[o]:f[o]=n(g,t||m,m):h;for(i||("function"==typeof e[o]?e[o].call(l,r):e[o]=r),c=0,p=d[o]||[],u=p.length;u>c;c++)a(p[c],r,!0);s("change",o)}var u={change:{},insert:{},delete:{}},d={},f={},p={len:e.length,pop:function(){var t=[].pop.apply(e);return this.len=this.values.length,s("delete",this.len,1),t},push:function(){var t=[].push.apply(e,arguments);return this.len=this.values.length,s("insert",this.len-1,1),t},reverse:function(){var t=[].reverse.apply(e);return this.len=e.length,s("delete",0,this.len),s("insert",0,this.len),t},shift:function(){var t=[].shift.apply(e);return this.len=e.length,s("delete",0,1),t},unshift:function(){var t=[].unshift.apply(e,arguments);return this.len=e.length,s("insert",0,1),t},sort:function(){var t=[].sort.apply(e,arguments);return s("delete",0,this.len),s("insert",0,this.len),t},splice:function(){var t=[].splice.apply(e,arguments);return this.len=e.length,arguments[1]&&s("delete",arguments[0],arguments[1]),arguments.length>2&&s("insert",arguments[0],arguments.length-2),t}},m=function(){return a.apply(null,arguments)},h={values:e,parent:o||null,root:t||m,on:l,off:c};return i(m,h),Array.isArray(e)&&i(m,p),m}"object"==typeof t&&(t.exports=n)},{}]},{},[5])(5)});