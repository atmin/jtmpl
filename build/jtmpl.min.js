/*! jtmpl 03-06-2014 */
!function(a){"use strict";function b(){var a=[].slice.call(arguments);return["GET","POST"].indexOf(a[0])>-1?b.xhr(a):"string"==typeof a[0]&&"object"==typeof a[1]&&["object","undefined"].indexOf(typeof a[2])>-1?b.compile.apply(null,a):void 0}function c(a,b){function c(a,b){return void 0===b?d[a]:d[a]=b}var d,e,f={pop:function(){d.pop();b([{type:"delete",name:d.length,object:d}])},push:function(){}};for(e in f)c[e]=f[e];return d=a,c}function d(a){return(a+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function e(a,b){return RegExp(d(a.delimiters[0])+"("+k+")"+d(a.delimiters[1]),b)}function f(a,c,d,e,f){var g,h,i=b.rules,j=b.rules.length;for(a=a.slice(f.delimiters[0].length,-f.delimiters[1].length),g=0;j>g;g++)if(h=i[g](a,c,d,e,f))return h}function g(a,b){return a.replace(e(b,"g"),function(b,c,d){var e=a.slice(0,d),f=!!e.match(RegExp("<"+j+"[^>]*?$")),g=!!e.match(/<!--\s*$/);return f||g?b:"<!--"+b+"-->"})}function h(a,b){var c=a.match(RegExp(d(b.delimiters[0])+"\\/"+j+d(b.delimiters[1])));return c?c[1]:!1}var i=/^[\w\.\-]+$/,j="([\\w\\.\\-]+)",k="[\\s\\S]*?",l={delimiters:["{{","}}"]};b.extend=function(a,b){var c,d={};for(c in a)a.hasOwnProperty(c)&&(d[c]=a[c]);for(c in b)b.hasOwnProperty(c)&&(d[c]=a[b]);return d},b.hasClass=function(a,b){return new RegExp("(\\s|^)"+b+"(\\s|$)").test(a.className)},b.addClass=function(a,c){b.hasClass(a,c)||(a.className+=(a.className&&" "||"")+c)},b.removeClass=function(a,c){b.hasClass(a,c)&&(a.className=a.className.replace(new RegExp("(\\s|^)"+c+"(\\s|$)"),"").replace(/^\s+|\s+$/g,""))},b.ObservableArray=c,b.bind=function(a,c,d){if(!a.__these__){var e=function(c){var d=function(f,g,h){var i,j,k;if(e.dependents[f]||(e.dependents[f]=[]),void 0===g||"function"==typeof g)return".."===f?a.__these__.parent:"/"===f?a.__these__.root:(c&&c!==f&&-1===e.dependents[f].indexOf(c)&&e.dependents[f].push(c),k="function"==typeof e.values[f]?e.values[f].call(d,g):e.values[f],"object"==typeof k?(b.bind(k,a.__these__.root,a),k.__these__(c)):k);for(h||("function"==typeof e.values[f]?e.values[f].call(d,g):e.values[f]=g),i=0,j=e.dependents[f].length;j>i;i++)d(e.dependents[f][i],void 0,!0);if(e.watchers[f])for(i=0,j=e.watchers[f].length;j>i;i++)e.watchers[f][i].call(d,g)};return d};e.dependents={},e.watchers={},e.root=c||a,e.parent=d||null,e.values={},Object.getOwnPropertyNames(a).map(function(b){e.values[b]=a[b],Object.defineProperty(a,b,{get:function(){return a.__these__()(b)},set:function(c){a.__these__()(b,c)}})}),Object.defineProperty(a,"__these__",{value:e})}},b.compile=function(a,c,d){var i,j,k,m,n,o,p,q,r,s,t,u,v,w,x=document.createDocumentFragment();for(d=d||l,a instanceof Node?q=a:(a=g(a,d),q=document.createElement("body"),q.innerHTML=a),i=0,j=q.childNodes,k=j.length;k>i;i++)switch(r=j[i],s=r.cloneNode(!1),x.appendChild(s),s.nodeType){case 1:for(m=0,n=s.attributes.length;n>m;m++)for(o=s.attributes[m],p=o.value,t=e(d,"g");u=t.exec(p);)v=f(u[0],s,o.name,c,d);s.appendChild(b.compile(r,c,d));break;case 8:if(h(s.data,d))throw"jtmpl: Unexpected "+s.data;if((u=s.data.match(e(d)))&&(v=f(s.data,u[1],null,c,d),v&&(v.replace instanceof Node&&s.parentNode.replaceChild(v.replace,s),v.block))){for(w=document.createDocumentFragment(),i++;k>i&&v.block!==h(j[i].data||"",d);i++)w.appendChild(j[i].cloneNode(!0));if(i===k)throw"jtmpl: Unclosed "+s.data;s.parentNode.replaceChild(v.replace(w,s.parentNode),s)}}return x},b.watch=function(a,c,d){var e;a&&c&&d&&(b.bind(a),e=a.__these__.watchers,e[c]||(e[c]=[]),-1===e[c].indexOf(d)&&e[c].push(d))},b.rules=[function(a,c,d,e,f){var g=a.match(i),h=function(d){(!!d&&b.addClass||b.removeClass)(c,a)};return"class"===d&&g?(b.watch(e,a,h),b.removeClass(c,f.delimiters[0]+a+f.delimiters[1]),{}):void 0},function(a,c,d,e){var f,g,h,i,k=a.match(new RegExp("#"+j)),l=document.createDocumentFragment(),m=function(a){return a&&l.appendChild(b.compile(g,e)),l};return k?(f=k[1],b.watch(e,f,m),{replace:function(a,b){return g=a,h=b,i=h.childNodes.length,m(e[f]),l},block:k[1]}):void 0},function(a,c,d,e){var f,g;return a.match(i)?d?(f=function(a){return a?c.setAttribute(d,a):c.removeAttribute(d)},b.watch(e,a,f),f(e[a]),{}):(g=document.createTextNode(e[a]||""),b.watch(e,a,function(a){g.data=a}),{replace:g}):void 0}],b.xhr=function(a){var b,c,d,e,f,g=new XMLHttpRequest,h=a.reduce(function(a,b){return"function"==typeof b?b:a},null),i=a[a.length-1];for("object"!=typeof i&&(i={}),b=0,e=Object.getOwnPropertyNames(i),c=e.length;c>b;b++)d=e[b],g[d]=i[d];f="string"==typeof a[2]?a[2]:"object"==typeof a[2]?Object.keys(a[2]).map(function(b){return b+"="+encodeURIComponent(a[2][b])}).join("&"):"",g.onload=function(a){var b;if(h){try{b=JSON.parse(this.responseText)}catch(c){b=this.responseText}h.call(this,b,a)}},g.open(a[0],a[1],void 0!==i.async?i.async:!0,i.user,i.password),g.send(f)},"undefined"==typeof module?a.jtmpl=b:exports=module.exports=b}(this);